function FileUploader(a,b,c,d){var f=this;this.wrapperObj=a;this.inputObj=b;this.fileObj=c;this.onUploaded=d;this.id=RegionUtil.getUUID();this.parasMap=new HashMap;var g=b.attr("paras");var h=b.attr("svc-url");var j=b.attr("limit-width");if(j!=null)this.limitWidth=parseInt(j);console.log("limitWidth:"+this.limitWidth);if(h==null){h=Config.backendPath+"/RCS_Objectsystem"}this.svcUrl=h;if(g!=null){var k=g.split(";");for(var l=0;l<k.length;l++){var m=k[l].split("=");this.parasMap.put(m[0].trim(),m[1].trim())}}this.wrapperObj.find(".attach-btn").click(function(){f.fileObj.click()});this.fileObj.change(function(n){var o=f.validation(n);if(o){if(f.wrapperObj.hasClass("img-wrapper")){var p=f.wrapperObj.find(".plus-view");var q=p.children(".img-view");q.removeClass("hidden");var r=q.find(".preview");try{var s=new FileReader;s.readAsDataURL(f.fileObj[0].files[0]);s.onload=function(){r[0].src=s.result;if(f.limitWidth!=null){setTimeout(function(){var y=f.compress(r[0],f.limitWidth);r[0].src=y;f.compressedImageData=y;p.children(".progress-cover").removeClass("hidden");p.children(".hint").addClass("hidden");p.children(".plus-btn").addClass("hidden");var z=f.inputObj.attr("status");if(z=="uploading"){RegionUtil.alert(global_msg.file_is_uploading)}else{f.inputObj.attr("status","uploading");f.uploadFile()}})}};if(f.limitWidth!=null)return;p.children(".progress-cover").removeClass("hidden");p.children(".hint").addClass("hidden");p.children(".plus-btn").addClass("hidden")}catch(A){console.log(A)}}else if(f.wrapperObj.hasClass("video-wrapper")){var p=f.wrapperObj.find(".plus-view");var t=p.children(".video-view");t.removeClass("hidden");var r=t.find(".preview");try{var s=new FileReader;s.readAsDataURL(f.fileObj[0].files[0]);s.onload=function(){r[0].src=s.result;if(f.limitWidth!=null){setTimeout(function(){r[0].src=newImageData;f.compressedImageData=newImageData;p.children(".progress-cover").removeClass("hidden");p.children(".hint").addClass("hidden");p.children(".plus-btn").addClass("hidden");var B=f.inputObj.attr("status");if(B=="uploading"){RegionUtil.alert(global_msg.file_is_uploading)}else{f.inputObj.attr("status","uploading");f.uploadFile()}})}};if(f.limitWidth!=null)return;p.children(".progress-cover").removeClass("hidden");p.children(".hint").addClass("hidden");p.children(".plus-btn").addClass("hidden")}catch(C){console.log(C)}}else if(f.wrapperObj.hasClass("file-wrapper")){var p=f.wrapperObj.find(".plus-view");f.wrapperObj.find(".ctrols>.attach-btn").addClass("hidden");var u=p.children(".progress-cover");var v=f.fileObj[0].files[0];u.children(".file-info").text(f.fileObj[0].files[0].name);u.children(".progress-block").text("");u.removeClass("hidden")}var w=f.inputObj.attr("status");if(w=="uploading"){RegionUtil.alert(global_msg.file_is_uploading)}else{f.inputObj.attr("status","uploading");f.uploadFile()}}});f.initWithExsitData()}FileUploader.prototype.initWithExsitData=function(){var D=this;var E=D.wrapperObj;if(E.hasClass("img-wrapper")){var F=E.find(".uploaded-imgs").children().length-1;var G=E.find(".wrapped").attr("limit-size");if(G==null)G=1;else G=parseInt(G);var H=E.find(".plus-view");if(F>=G){H.addClass("hidden")}else{H.removeClass("hidden")}E.find(".img-view>.preview").click(function(I){var J=new HashMap;J.put("imgBase64",$(this).attr("src"));openDrawerWindow(RegionUtil.appendParaMapToUrl("common/shared/preview/img-preview.rs",J),"图片预览","s")});E.find(".uploaded-imgs .delete-btn").click(function(K){D.deleteImage(this)})}else if(E.hasClass("video-wrapper")){var F=E.find(".uploaded-videos").children().length-1;var G=E.find(".wrapped").attr("limit-size");if(G==null)G=1;else G=parseInt(G);var H=E.find(".plus-view");if(F>=G){H.addClass("hidden")}else{H.removeClass("hidden")}E.find(".video-view>.preview").click(function(L){var M=new HashMap;M.put("url",$(this).attr("src"));openDrawerWindow(RegionUtil.appendParaMapToUrl("common/shared/preview/img-preview.rs",M),"图片预览","s")});E.find(".uploaded-videos .delete-btn").click(function(N){D.deleteVideo(this)})}else if(E.hasClass("file-wrapper")){var F=E.find(".uploaded-files").children().length-1;var G=E.find(".wrapped").attr("limit-size");if(G==null)G=1;else G=parseInt(G);if(F>=G){E.find(".ctrols>.attach-btn").addClass("hidden")}else{E.find(".ctrols>.attach-btn").removeClass("hidden")}E.find(".uploaded-files .delete-btn").click(function(O){D.deleteFile(this)});E.find(".uploaded-files .file-info").click(function(P){var Q=new HashMap;Q.put("url",this.getAttribute("file-url"));if(AndroidClient.isFromWebview){RegionUtil.gotoScreen("videoPreview",Q)}else{window.open(this.getAttribute("file-url"),"_blank")}})}};FileUploader.prototype.compress=function(R,S,T,U){if(T==null)T=100;if(U==null)U="jpeg";var V="image/"+U;var W=document.createElement("canvas");var X=R.naturalHeight;var Y=R.naturalWidth;if(parseInt(R.naturalWidth)>S){var Z=parseInt(R.naturalWidth)/S;X=R.naturalHeight/Z;Y=S}W.width=Y;W.height=X;var _=W.getContext("2d").drawImage(R,0,0,R.naturalWidth,R.naturalHeight,0,0,Y,X);return W.toDataURL(V,T/100)};FileUploader.prototype.dataURItoBlob=function(aa){var ba=aa.split(","),ca=ba[0].match(/:(.*?);/)[1],da=atob(ba[1]),ea=da.length,fa=new Uint8Array(ea);while(ea--){fa[ea]=da.charCodeAt(ea)}return new Blob([fa],{type:ca})};FileUploader.prototype.uploadFile=function(){var ga=this;if(ga.compressedImageData!=null){var ha=ga.dataURItoBlob(ga.compressedImageData);ga.compressedImageData=null;ga.targetFileBlob=ha;ga.targetFileBlob.name=this.fileObj[0].files[0].name}else{ga.targetFileBlob=this.fileObj[0].files[0]}var ia=this.inputObj.attr("vendor");if(ia==null)ia=Config.fileVendor;if(ia==null)ia="cloud";var ja=this.inputObj.attr("store-path");if(ja!=null&&!ja.endsWith("/"))ja=ja+"/";var ka=this.inputObj.attr("file-type");if(ka==null)ka="file";var la=RegionUtil.calculateMD5(ga.targetFileBlob);la.done(function(ma){var na=new Object;na.md5=ma;na.vendor=ia;na.upToken=RegionUtil.getCookie("fileUpToken");na.fileType=ka;na.storePath=ja;RegionUtil.ajaxJsonTask(ga.svcUrl+"/objectsystem/pre-upload","POST",na,function(oa,pa){var qa=oa.data;console.log(qa);if(!qa.recordExsit){if(qa.upToken!=null){RegionUtil.setCookieWithExpire("fileUpToken",qa.upToken,"s"+60);na.upToken=qa.upToken}if(ia=="local"){ga.uploadFileToLocal(qa.fileKeyPrefix,na.md5,na.fileType)}else if(ia=="cloud"){ga.uploadFileToCloud(qa.fileKeyPrefix,na.upToken,na.md5,na.fileType)}}else{ga.inputObj.val(qa.fileId);ga.inputObj.attr("status",null)}})})};FileUploader.prototype.deleteImage=function(ra){var sa=this;var ta=$(ra).parent();var ua=ta.attr("file-id");ta.remove();var va=sa.inputObj.val();var wa=va.indexOf(ua);var xa;if(va==ua){xa=""}else{if(wa==0){xa=va.substring(ua.length+1,va.length)}else{xa=va.substring(0,wa-1)+va.substring(wa+ua.length,va.length)}}sa.inputObj.val(xa);var ya=sa.inputObj.attr("limit-size");if(ya==null)ya=1;else ya=parseInt(ya);var za=sa.wrapperObj.find(".uploaded-imgs").children().length-1;var Aa=sa.wrapperObj.find(".plus-view");if(za<ya){Aa.removeClass("hidden")}};FileUploader.prototype.deleteVideo=function(Ba){var Ca=this;var Da=$(Ba).parent();var Ea=Da.attr("file-id");Da.remove();var Fa=Ca.inputObj.val();var Ga=Fa.indexOf(Ea);var Ha;if(Fa==Ea){Ha=""}else{if(Ga==0){Ha=Fa.substring(Ea.length+1,Fa.length)}else{Ha=Fa.substring(0,Ga-1)+Fa.substring(Ga+Ea.length,Fa.length)}}Ca.inputObj.val(Ha);var Ia=Ca.inputObj.attr("limit-size");if(Ia==null)Ia=1;else Ia=parseInt(Ia);var Ja=Ca.wrapperObj.find(".uploaded-videos").children().length-1;var Ka=Ca.wrapperObj.find(".plus-view");if(Ja<Ia){Ka.removeClass("hidden")}};FileUploader.prototype.deleteFile=function(La){var Ma=this;var Na=$(La).parent();var Oa=Na.attr("file-id");Na.remove();var Pa=Ma.inputObj.val();var Qa=Pa.indexOf(Oa);var Ra;if(Pa==Oa){Ra=""}else{if(Qa==0){Ra=Pa.substring(Oa.length+1,Pa.length)}else{Ra=Pa.substring(0,Qa-1)+Pa.substring(Qa+Oa.length,Pa.length)}}Ma.inputObj.val(Ra);var Sa=Ma.inputObj.attr("limit-size");if(Sa==null)Sa=1;else Sa=parseInt(Sa);var Ta=Ma.wrapperObj.find(".uploaded-files").children().length-1;if(Ta<Sa){Ma.wrapperObj.find(".ctrols>.attach-btn").removeClass("hidden")}};FileUploader.prototype.uploadComplete=function(result){var fileUploader=this;fileUploader.inputObj.attr("status",null);fileUploader.wrapperObj.find(".cancel-btn").addClass("hidden");var plusView=fileUploader.wrapperObj.find(".plus-view");if(fileUploader.wrapperObj.hasClass("img-wrapper")){plusView.children(".hint").removeClass("hidden");plusView.children(".plus-btn").removeClass("hidden");plusView.children(".progress-cover").addClass("hidden")}if(fileUploader.wrapperObj.hasClass("video-wrapper")){plusView.children(".hint").removeClass("hidden");plusView.children(".plus-btn").removeClass("hidden");plusView.children(".progress-cover").addClass("hidden")}else if(fileUploader.wrapperObj.hasClass("file-wrapper")){fileUploader.wrapperObj.find(".progress-cover").addClass("hidden")}if(result==2){console.log("exception");if(fileUploader.wrapperObj.hasClass("img-wrapper")){plusView.children(".img-view").addClass("hidden")}else if(fileUploader.wrapperObj.hasClass("video-wrapper")){plusView.children(".video-view").addClass("hidden")}}else if(result==3){console.log("cancel");if(fileUploader.wrapperObj.hasClass("img-wrapper")){plusView.children(".img-view").addClass("hidden")}else if(fileUploader.wrapperObj.hasClass("video-wrapper")){plusView.children(".video-view").addClass("hidden")}}else{var fileIds=fileUploader.inputObj.val();if(fileIds==null)fileIds="";if(fileIds.length==0){fileIds=result.fileId}else{fileIds+=","+result.fileId}fileUploader.inputObj.val(fileIds);btn=fileUploader.wrapperObj.find(".delete-btn");btn.removeClass("hidden");if(fileUploader.wrapperObj.hasClass("img-wrapper")){var plusView=fileUploader.wrapperObj.find(".plus-view");var wrappedObj=fileUploader.wrapperObj.find(".wrapped");var imgView=plusView.children(".img-view").remove();imgView.attr("file-id",result.fileId);imgView.insertBefore(fileUploader.wrapperObj.find(".uploaded-imgs>.brace"));RegionUtil.appendHtml(RegionUtil.getRegionByElem(imgView[0]),imgView[0],'<div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div>');imgView.children(".preview").click(function(Ua){var Va=new HashMap;Va.put("imgBase64",$(this).attr("src"));RegionUtil.openModalWindow(RegionUtil.appendParaMapToUrl("common/shared/preview/img-preview.rs",Va),"图片预览",2,.7,.7,null,null,false,true)});imgView.children(".delete-btn").click(function(Wa){fileUploader.deleteImage(this)});var limitSize=wrappedObj.attr("limit-size");if(limitSize==null)limitSize=1;else limitSize=parseInt(limitSize);RegionUtil.appendHtml(RegionUtil.getRegionByElem(plusView[0]),plusView[0],'<div class="img-view"><img class="preview"></div>');var uploadedCount=fileUploader.wrapperObj.find(".uploaded-imgs").children().length-1;if(uploadedCount>=limitSize){plusView.addClass("hidden")}}else if(fileUploader.wrapperObj.hasClass("video-wrapper")){var plusView=fileUploader.wrapperObj.find(".plus-view");var wrappedObj=fileUploader.wrapperObj.find(".wrapped");var videoView=plusView.children(".video-view").remove();videoView.attr("file-id",result.fileId);videoView.insertBefore(fileUploader.wrapperObj.find(".uploaded-videos>.brace"));RegionUtil.appendHtml(RegionUtil.getRegionByElem(videoView[0]),videoView[0],'<div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div>');videoView.children(".preview").click(function(Xa){var Ya=new HashMap;Ya.put("url",$(this).attr("src"));RegionUtil.openModalWindow(RegionUtil.appendParaMapToUrl("common/shared/preview/video-preview.rs",Ya),"视频预览",2,.7,.7,null,null,false,true)});videoView.children(".delete-btn").click(function(Za){fileUploader.deleteVideo(this)});var limitSize=wrappedObj.attr("limit-size");if(limitSize==null)limitSize=1;else limitSize=parseInt(limitSize);RegionUtil.appendHtml(RegionUtil.getRegionByElem(plusView[0]),plusView[0],'<div class="video-view"><video class="preview"></div>');var uploadedCount=fileUploader.wrapperObj.find(".uploaded-videos").children().length-1;if(uploadedCount>=limitSize){plusView.addClass("hidden")}}else if(fileUploader.wrapperObj.hasClass("file-wrapper")){var plusView=fileUploader.wrapperObj.find(".plus-view");var wrappedObj=fileUploader.wrapperObj.find(".wrapped");var fileItemHtml='<div class="file-view" file-id="'+result.fileId+'"><div class="file-info" file-url="'+RegionUtil.fixUrl(result.url)+'">'+plusView.find(".file-info").text()+'</div><div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div>';var braceObj=fileUploader.wrapperObj.find(".uploaded-files>.brace");RegionUtil.insertBefore(RegionUtil.getRegionByElem(braceObj[0]),braceObj[0],fileItemHtml);var fileView=fileUploader.wrapperObj.find(".uploaded-files>.file-view:last");fileView.children(".delete-btn").click(function($a){fileUploader.deleteFile(this)});fileView.children(".file-info").click(function(_a){var a0=new HashMap;a0.put("url",this.getAttribute("file-url"));if(AndroidClient.isFromWebview){RegionUtil.gotoScreen("videoPreview",a0)}else{window.open(this.getAttribute("file-url"),"_blank")}});var limitSize=wrappedObj.attr("limit-size");if(limitSize==null)limitSize=1;else limitSize=parseInt(limitSize);var uploadedCount=fileUploader.wrapperObj.find(".uploaded-files").children().length-1;if(uploadedCount>=limitSize){fileUploader.wrapperObj.find(".ctrols>.attach-btn").addClass("hidden")}else{fileUploader.wrapperObj.find(".ctrols>.attach-btn").removeClass("hidden")}}fileUploader.wrapperObj.find(".progress-block").text("");if(!!this.onUploaded){eval(this.onUploaded+".call(this,fileIds)")}}fileUploader.fileObj[0].value=""};FileUploader.prototype.uploadFileToCloud=function(b0,c0,d0,e0){var f0=this;var g0=f0.targetFileBlob;var h0=new jQuery.Deferred;var i0=h0.promise();i0.done(function(l0){f0.uploadComplete(l0)});this.observer={next:function(m0){f0.wrapperObj.find(".progress-block").text(Math.round(m0.total.percent)+"%")},error:function(n0){RegionUtil.error(n0);h0.resolve(2)},complete:function(o0){RegionUtil.debug("complete");f0.confirmCloudFileUploaded(d0,o0.key,e0,h0)}};var j0=qiniu.upload(g0,b0+g0.name,c0,null,null);var k0=f0.wrapperObj.find(".cancel-btn");k0.removeClass("hidden");k0.unbind("click");k0.click(function(){f0.subscription.unsubscribe();h0.resolve(3)});this.subscription=j0.subscribe(this.observer)};FileUploader.prototype.confirmCloudFileUploaded=function(p0,q0,r0,s0){var t0=this;var u0=new Object;u0.md5=p0;u0.fileKey=q0;RegionUtil.ajaxJsonTask(t0.svcUrl+"/objectsystem/confirm-upload","POST",u0,function(v0,w0){var x0=v0.data;s0.resolve(x0);if(window.filesInfo==null){window.filesInfo={}}window.filesInfo[v0.data.fileId]=v0.data})};FileUploader.prototype.uploadFileToLocal=function(y0,z0,A0){var B0=this;var C0=B0.targetFileBlob;var D0=new jQuery.Deferred;var E0=D0.promise();E0.done(function(H0){B0.uploadComplete(H0)});var F0=new FormData;F0.append("upfile",C0);F0.append("md5",z0);F0.append("fileType",A0);this.processingFileReq=$.ajax({type:"POST",url:B0.svcUrl+"/objectsystem/local-upload",data:F0,processData:false,contentType:false,xhr:function(){var I0=$.ajaxSettings.xhr();if(I0.upload){I0.upload.addEventListener("progress",function(J0){var K0=RegionUtil.getEventTarget(J0);var L0=J0.loaded;var M0=J0.total;var N0=Math.floor(100*L0/M0);B0.wrapperObj.find(".progress-block").text(Math.round(N0)+"%")},false);return I0}},success:function(O0){console.log(O0);if(O0.success==true){D0.resolve(O0.data[0])}},error:function(P0,Q0,R0){if(P0.readyState==0){}else{D0.resolve(2)}}});var G0=B0.wrapperObj.find(".cancel-btn");G0.removeClass("hidden");G0.unbind("click");G0.click(function(){B0.processingFileReq.abort();D0.resolve(3)})};FileUploader.prototype.validation=function(S0){if(this.fileObj[0].files[0]==undefined)return false;var T0=this.parasMap.get("maxsize");var U0=this.parasMap.get("accept");if(T0==null){T0=2e4}else{T0=parseInt(T0)}if(T0>0){if(this.fileObj[0].files[0].size>T0*1e3){RegionUtil.alert(global_msg.file_size_limit+T0+"KB");return false}}if(U0==null||U0=="")U0="*";if(U0!="*"){var V0=U0.split(",");var W0=0,X0=false;for(W0=0;W0<V0.length;W0++){if(this.fileObj[0].files[0].name.toLowerCase().endWith(V0[W0].toLowerCase())){X0=true;break}}if(X0==false){RegionUtil.alert(global_msg.file_type_limit+",支持的类型有 :"+U0);return false}}return true};function EventBus(){this.eventHub={};this.eventCodeRegisterByRegionId={}}EventBus.prototype.newListener=function(Y0){var Z0={};Z0.handle=Y0;return Z0};EventBus.prototype.addEventListener=function($0,_0){if(_0.id==null){_0.id=RegionUtil.UUID()}var ab=this.eventHub[$0];if(ab==null){ab={};this.eventHub[$0]=ab}ab[_0.id]=_0;if(_0.regionId!=null){var bb=this.eventCodeRegisterByRegionId[_0.regionId];if(bb==null){bb={};this.eventCodeRegisterByRegionId[_0.regionId]=bb}bb[$0]=true}};EventBus.prototype.removeListenersForRegion=function(cb){var db=this.eventCodeRegisterByRegionId[cb.regionId];for(eventCode in db){var eb=this.eventHub[eventCode];if(eb!=null){for(listenerId in eb){var fb=eb[listenerId];if(fb.regionId==cb.regionId){delete eb[listenerId]}}}}};EventBus.prototype.removeListener=function(gb,hb){var ib=this.eventHub[gb];if(ib!=null){delete ib[hb.id]}};EventBus.prototype.publishEvent=function(jb){var kb=this.eventHub[jb.eventCode];if(kb!=null){for(listenerId in kb){try{kb[listenerId].handle(jb.eventData)}catch(lb){console.log(lb)}}}};var CoverPlugin={interval:200,isCoverShown:false,showCount:0,checkThreadRuning:false,loadingStart:function(mb){if(!CoverPlugin.isCoverShown){CoverPlugin.subShowCover(mb);CoverPlugin.startCheckThread()}CoverPlugin.showCount++},loadingComplete:function(){if(CoverPlugin.showCount>0)CoverPlugin.showCount--},startCheckThread:function(){CoverPlugin.startLoading=(new Date).getTime();setTimeout(CoverPlugin.checkCover,CoverPlugin.interval)},checkCover:function(){if(CoverPlugin.showCount==0){CoverPlugin.subHideCover()}else{if((new Date).getTime()-CoverPlugin.startLoading>8e3){CoverPlugin.showCount=0;CoverPlugin.subHideCover()}else{setTimeout(CoverPlugin.checkCover,CoverPlugin.interval)}}},subShowCover:function(nb){console.log("showcover");var ob=CoverPlugin.getLoadingCoverDiv();var pb={x:0,y:0};var qb={p_margin:.4};if(window.innerWidth){pb.x=window.innerWidth}else if(document.body&&document.body.clientWidth){pb.x=document.body.clientWidth}if(window.innerHeight){pb.y=window.innerHeight}else if(document.body&&document.body.clientHeight){pb.y=document.body.clientHeight}if(nb!=null)ob.addClass(nb);ob.attr("tp-class",nb);$(ob.children("div").get(0)).css("margin-top",pb.y*qb.p_margin);$(ob.children("div").get(0)).removeClass("hidden");ob.removeClass("hidden");CoverPlugin.blockInput();CoverPlugin.isCoverShown=true},subHideCover:function(){console.log("hidecover");var rb=CoverPlugin.getLoadingCoverDiv();var sb=rb.attr("tp-class");if(sb!=null){rb.removeClass(sb);rb.attr("tp-class",null)}$(rb.children("div").get(0)).addClass("hidden");rb.addClass("hidden");CoverPlugin.unBlockInput();CoverPlugin.isCoverShown=false},getLoadingCoverDiv:function(){if(window._LCD==null){var tb=document.createElement("i");tb.className="fa fa-spinner fa-pulse fa-3x fa-fw";var ub=document.createElement("div");ub.className="dialog_progress hidden";ub.appendChild(tb);var vb=document.createElement("div");vb.className="cover_div hidden";vb.appendChild(ub);document.body.appendChild(vb);window._LCD=$(vb)}return window._LCD},blockInput:function(){document.onkeydown=function(wb){var xb=document.all?true:false;var yb;var zb;if(xb){yb=window.event.keyCode;zb=window.event}else{yb=wb.which;zb=wb}if(yb==9||yb==13){if(xb){zb.keyCode=0;zb.returnValue=false}else{zb.which=0;zb.preventDefault()}}}},unBlockInput:function(){document.onkeydown=null}};var LoginPlugin={PC_lOGIN_URL:"index.html",PC_LANDINGPAGE_URL:"landing.html",PC_ACTIVE_ACCOUNT_URL:"admin/login/account_active.html",APP_lOGIN_URL:"app/login.html",APP_LANDINGPAGE_URL:"app/app.html",APP_ACTIVE_ACCOUNT_URL:"activeaccount",preLoginFlag:"preLogin",preLogin:function(){if(RegionUtil.getCookie(LoginPlugin.preLoginFlag)!="y"){RegionUtil.setCookieWithExpire(LoginPlugin.preLoginFlag,"y","s5");if(RegionUtil.isPc()){var Ab=RegionUtil.alert("会话已过期,请重新登录");Ab.done(function(){RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.PC_lOGIN_URL)})}else{RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.APP_lOGIN_URL)}}},oneTimePasswordLogin:function(Bb){var Cb=RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Auth/oneTimePasswordLogin","POST",{oneTimePassword:Bb},function(Db,Eb){if(!Db.success){RegionUtil.alert(Db.msg)}else{if(RegionUtil.isPc()){RegionUtil.replacePage(Config.frontendPath+LoginPlugin.PC_LANDINGPAGE_URL)}else{RegionUtil.replacePage(Config.frontendPath+LoginPlugin.APP_LANDINGPAGE_URL)}}},true);return Cb},login:function(Fb,Gb,Hb,Ib){var Jb=SparkMD5.hash(Gb.trim()).toUpperCase();var Kb=Fb.trim();var Lb=RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Auth/login","POST",{account:Kb,password:Jb,spName:Hb,verifycode:Ib},function(Mb,Nb){if(!Mb.validAccount){if(Mb.loginResponseType=="EXPIRED_VERIFYIMG"){RegionUtil.toast("验证码已过期，请刷新")}else if(Mb.loginResponseType=="INVALID_VERIFYIMG"){RegionUtil.toast("验证码错误")}else if(Mb.loginResponseType=="ACCOUNT_TO_BE_ACTIVED"){if(RegionUtil.isPc()){RegionUtil.alert("请先激活帐号")}else{RegionUtil.toast("此账户未激活")}}else if(Mb.loginResponseType=="ACCOUNT_LOCKED"){RegionUtil.toast("账号已锁定")}else{if(RegionUtil.isPc()){RegionUtil.toast("账号不存在或密码错误")}else{RegionUtil.toast("账号不存在或密码错误")}}}else{if(RegionUtil.isPc()){RegionUtil.replacePage(Config.frontendPath+LoginPlugin.PC_LANDINGPAGE_URL)}else{RegionUtil.replacePage(Config.frontendPath+LoginPlugin.APP_LANDINGPAGE_URL)}}},true);return Lb},logout:function(){return RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Auth/logout","POST",null,function(Ob,Pb){RegionUtil.delCookie("_region_login");if(RegionUtil.isPc()){RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.PC_lOGIN_URL)}else{RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.APP_lOGIN_URL)}},true,function(){RegionUtil.delCookie("_region_login");if(RegionUtil.isPc()){RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.PC_lOGIN_URL)}else{RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.APP_lOGIN_URL)}})},register:function(Qb,Rb,Sb,Tb,Ub){var Vb=RegionUtil.SHA256(SparkMD5.hash(Rb.trim()).toUpperCase()).toUpperCase();var Wb=Qb.trim();var Xb=RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Auth/register","POST",{account:Wb,password:Vb,spName:Sb,smsCode:Tb,smsCodeKey:Ub},function(Yb,Zb){if(Yb.success){var $b=RegionUtil.alert("注册成功");$b.done(function(){if(RegionUtil.isPc()){window.open(Config.frontendPath+LoginPlugin.PC_LANDINGPAGE_URL,"_blank")}else{RegionUtil.replacePage(Config.frontendPath+LoginPlugin.APP_LANDINGPAGE_URL)}})}else{if(loginResultJson.respCode=="_701"){RegionUtil.toast("验证码错误")}else if(loginResultJson.respCode=="_702"){RegionUtil.toast("验证码已过期")}}},true);return Xb},activeByPassword:function(_b){var a1=RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Auth/active-account-bypasswords","POST",{password:_b},function(b1,c1){if(b1.loginResponseType=="LOGIN_SUCCESSFULLY"){var d1=null;var e1="帐号激活成功";if(RegionUtil.isPc()){d1=RegionUtil.alert(e1)}else{d1=RegionUtil.alert(e1)}d1.done(function(){if(RegionUtil.isPc()){window.open(Config.frontendPath+LoginPlugin.PC_LANDINGPAGE_URL,"_blank")}else{RegionUtil.replacePage(Config.frontendPath+LoginPlugin.APP_LANDINGPAGE_URL)}})}else{var d1=null;var e1="激活失败";if(RegionUtil.isPc()){d1=RegionUtil.alert(e1)}else{d1=RegionUtil.alert(e1)}d1.done(function(){if(RegionUtil.isPc()){RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.PC_lOGIN_URL)}else{RegionUtil.getTopWindow(window).location.replace(Config.frontendPath+LoginPlugin.APP_lOGIN_URL)}})}});return a1}};var AlertPlugin={msgQueue:new Array,toastQueue:new Array,consumeMsgQueue:function(){if(AlertPlugin.msgQueue.length>0){var f1=AlertPlugin.msgQueue.pop();if(f1.type==1){var g1=new HashMap;g1.put("msg",f1.msg);if(RegionUtil.isPc())AlertPlugin.showMsg(f1.title,380,200,"common/shared/popup/alert.rs",g1);else AlertPlugin.showMsg(f1.title,350,200,"common/shared/popup/alert.rs",g1);AlertPlugin.msgDef=f1.msgDef;AlertPlugin.msgPromise=f1.msgPromise}else if(f1.type==2){AlertPlugin.yesCallBack=f1.yesCallBack;AlertPlugin.noCallBack=f1.noCallBack;var g1=new HashMap;g1.put("msg",f1.msg);if(RegionUtil.isPc())AlertPlugin.showMsg(f1.title,380,200,"common/shared/popup/confirm.rs",g1);else AlertPlugin.showMsg(f1.title,350,200,"common/shared/popup/appconfirm.rs",g1);AlertPlugin.msgDef=new jQuery.Deferred;AlertPlugin.msgPromise=AlertPlugin.msgDef.promise()}}},alert:function(h1,i1){return RS.toast(h1,2500)},confirm:function(j1,k1,l1,m1){var n1={};n1.type=2;n1.msg=j1;n1.title=k1;n1.yesCallBack=l1;n1.noCallBack=m1;n1.msgDef=new jQuery.Deferred;n1.msgPromise=n1.msgDef.promise();AlertPlugin.msgQueue.push(n1);if(AlertPlugin.msgPromise==null){AlertPlugin.consumeMsgQueue()}else{AlertPlugin.msgPromise.done(function(){AlertPlugin.consumeMsgQueue()})}return n1.msgPromise},yes:function(o1){if(AlertPlugin.yesCallBack!=null&&typeof AlertPlugin.yesCallBack==="function"){AlertPlugin.yesCallBack()}AlertPlugin.hideMsg(o1,true)},no:function(p1){if(AlertPlugin.noCallBack!=null&&typeof AlertPlugin.yesCallBack==="function"){AlertPlugin.noCallBack()}AlertPlugin.hideMsg(p1,false)},hideMsg:function(q1,r1){var s1=RegionUtil.getEventTarget(q1);var t1=$(s1).closest(".cover-container");t1.find(".animation-holder").addClass("moveout-animation2-class");t1.find(".animation-holder").removeClass("movein-animation2-class");RegionUtil.enableScrollAfterPopupClosed();t1.find(".animation-holder").bind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t1.remove();if(r1==null)r1=false;if(AlertPlugin.msgDef!=null){var u1=AlertPlugin.msgDef;AlertPlugin.msgDef=null;AlertPlugin.msgPromise=null;u1.resolve(r1)}})},showMsg:function(v1,w1,x1,y1,z1){var A1=document.createElement("div");A1.className="hidden cover-container";var B1=$(A1);B1.html(AlertPlugin.alertHtml);document.body.appendChild(B1[0]);$(window).resize(function(){var D1=parseInt(document.documentElement.style.fontSize);B1.width=D1*26;B1.height=D1*14;RegionUtil.calPositionWithFixedSize(B1.find(".cover-window"),B1.width,B1.height)});if(v1!=null)B1.find(".title").text(v1);var C1=parseInt(document.documentElement.style.fontSize);B1.width=C1*26;B1.height=C1*14;B1.find(".animation-holder").removeClass("moveout-animation2-class");B1.find(".animation-holder").addClass("movein-animation2-class");B1.removeClass("hidden");RegionUtil.disableScrollAfterPopupOpened();RegionUtil.calPositionWithFixedSize(B1.find(".cover-window"),B1.width,B1.height);if(y1=="common/shared/popup/alert.rs"){RegionUtil.loadRegionByContent(B1.find(".modal-container"),null,AlertPlugin.alertRS,z1,"REGIONmsgWindow")}else{if(!RegionUtil.isPc()){}RegionUtil.loadRegion(B1.find(".modal-container"),RegionUtil.appendParaMapToUrl(y1,z1),"REGIONmsgWindow")}},alertRS:'<div id="REGION" class="hidden text-center">\r\n'+'\t<div class="alert-content"><span style="position: relative;top: 20%" region-attr="msg"></span></div>\r\n'+"\t<button class=\"btn\" data-type='primary' normal onclick='AlertPlugin.hideMsg(event)'><message key=\"global_msg.ok\"></message></button>\r\n"+"</div>\t\r\n"+'<script type="text/javascript">\r\n'+"RegionUtil.ready(function(){\r\n"+'\tvar formRegion = RegionUtil.newFormRegion("#REGION");\r\n'+"\tformRegion.renderRegion();\r\n"+"})\r\n"+"<\/script>",alertHtml:"<div class='cover-bgdiv alert-div'>"+"\t<div class='cover-window'>"+"\t \t<div class='animation-holder'>"+"\t\t\t<div class='cover-header col-xs-12'>"+"\t\t\t\t<div class='title'>"+"\t\t\t\t</div>"+"\t\t\t\t<div class='pull-right' style='height:100%'>"+"\t\t\t\t\t<span class='fa-solid fa-remove popclose' aria-hidden='true' onclick='AlertPlugin.hideMsg(event,false)'></span>"+"\t\t\t\t</div>"+"\t\t\t</div>"+"\t\t\t<div class='modal-container-wrap col-xs-12'>"+"\t\t\t\t<div class='modal-container scroll-bar2'>"+"\t\t\t\t</div>"+"\t\t\t</div>"+"\t\t</div>"+"\t</div>"+"</div>",toastHtml:"<div class='toast-div'>"+"\t<div class='cover-window'>"+"\t \t<div class='animation-holder'>"+"\t\t\t<div class='toast-wrap'>"+"\t\t\t\t<div class='modal-container scroll-bar2'>"+"\t\t\t\t</div>"+"\t\t\t</div>"+"\t\t</div>"+"\t</div>"+"</div>",promptHolderPromise:null,getPromptHolderPromise:function(){if(AlertPlugin.promptHolderPromise==null){var E1=document.createElement("div");document.body.appendChild(E1);$(E1).addClass("prompt-holder");AlertPlugin.promptHolderPromise=RegionUtil.loadRegion($(E1),"common/shared/popup/promptHolder.rs")}return AlertPlugin.promptHolderPromise},prompt:function(F1,G1,H1,I1,J1,K1){if(H1==null)H1=5e3;if(I1==null)I1='<i class="fa-regular fa-circle-info"></i>';if(J1==null)J1="common/shared/popup/defaultPromptCard.rs";if(K1==null)K1=new HashMap;K1.put("title",F1);K1.put("msg",G1);K1.put("duration",H1);K1.put("icon",I1);var L1=new jQuery.Deferred;var M1=AlertPlugin.getPromptHolderPromise();M1.done(function(N1){var O1=N1.prompt(RS.appendParaMapToUrl(J1,K1));O1.done(function(){L1.resolve()})});return L1.promise()},toastHolderPromise:null,getToastHolderPromise:function(){if(AlertPlugin.toastHolderPromise==null){var P1=document.createElement("div");document.body.appendChild(P1);$(P1).addClass("toast-holder");AlertPlugin.toastHolderPromise=RegionUtil.loadRegion($(P1),"common/shared/popup/toastHolder.rs")}return AlertPlugin.toastHolderPromise},toast:function(Q1,R1,S1,T1,U1){if(R1==null)R1=3e3;if(S1==null)S1='<i class="fa-regular fa-circle-info"></i>';if(T1==null)T1="common/shared/popup/defaultToastCard.rs";if(U1==null)U1=new HashMap;U1.put("msg",Q1);U1.put("duration",R1);U1.put("icon",S1);var V1=new jQuery.Deferred;var W1=AlertPlugin.getToastHolderPromise();W1.done(function(X1){var Y1=X1.toast(RS.appendParaMapToUrl(T1,U1));Y1.done(function(){V1.resolve()})});return V1.promise()}};var ErrorPromptPlugin={showErrorMsg:function(Z1,$1,_1){var ac=RegionUtil.getRegionByElem(Z1);ErrorPromptPlugin.cleanErrorMsg(Z1,$1,ac);if(Z1.getAttribute("type")=="hidden"||$(Z1).hasClass("wrapped")){Z1=$(Z1).parent()[0]}var bc='<div class="error-msg">'+$1.errorMsg+"</div>";RegionUtil.insertAfter(ac,Z1,bc)},cleanErrorMsg:function(cc,dc,ec){if(cc.getAttribute("type")=="hidden"||$(cc).hasClass("wrapped")){cc=$(cc).parent()[0]}var fc=$(cc).next();if(fc.hasClass("error-msg"))fc.remove()},cleanErrorsForRegion:function(gc){gc.find(".error-msg").remove()}};PaginationPlugin={renderPaginationControl:function(hc,ic,jc,kc,lc,mc,nc){if(ic.length==0)return;if(jc==0){ic.find(".control").html("");ic.find(".info").html("");return}if(!RegionUtil.isPc()){ic.attr("showgo","false");ic.attr("showinfo","false")}if(ic.find(".control").length==0){ic.append('<div class="control"></div>')}if(ic.find(".info").length==0){ic.append('<div class="info"></div>')}var oc={totalPageAmount:parseInt(lc),currentPageNo:parseInt(kc),pageBtnShowAmount:parseInt(nc)?parseInt(nc):9,pageBtnShowStart:null,pageBtnShowEnd:null,pageExtendBtnLeftShow:false,pageExtendBtnRightShow:false,template:$("<button>").addClass("btn btn-info btn-sm")};var pc='<div class="btn-group">';pc+="<button data-type='default' plain class=\"btn btn-info btn-sm refreshBtn\" onclick=\"RegionUtil.getRegionByEvent(event).refreshRegion()\"><i title='Refresh' class='fa-solid fa-undo'></i></i></button>";if(oc.totalPageAmount>oc.pageBtnShowAmount){var qc=parseInt(oc.pageBtnShowAmount/2);oc.pageBtnShowStart=oc.currentPageNo-qc;oc.pageBtnShowEnd=oc.pageBtnShowStart+oc.pageBtnShowAmount-1;if(oc.pageBtnShowStart<1){oc.pageBtnShowStart=1;oc.pageBtnShowEnd=oc.pageBtnShowStart+oc.pageBtnShowAmount-1}if(oc.pageBtnShowEnd>oc.totalPageAmount){oc.pageBtnShowEnd=oc.totalPageAmount;oc.pageBtnShowStart=oc.pageBtnShowEnd-oc.pageBtnShowAmount+1}oc.pageExtendBtnLeftShow=true;oc.pageExtendBtnRightShow=true}else{oc.pageBtnShowStart=1;oc.pageBtnShowEnd=oc.totalPageAmount}if(oc.pageExtendBtnLeftShow){var rc=oc.template.clone().addClass("pageExtendBtn pageExtendBtnUp");rc.append($("<i>").addClass("fa fa-angle-double-left"));pc+=rc.prop("outerHTML")}pc+='<button class="btn btn-info btn-sm prePageBtn" title="Previous"><i class="fa fa-angle-left"></i></button>';for(var sc=oc.pageBtnShowStart;sc<=oc.pageBtnShowEnd;sc++){var rc=oc.template.clone().attr("pageNo",sc).addClass("pageIndexBtn").text(sc);if(sc==oc.currentPageNo){rc.addClass("pageIndexBtnCurrent");rc.attr("disabled",true)}pc+=rc.prop("outerHTML")}pc+='<button class="btn btn-info btn-sm nextPageBtn" title="Next"><i class="fa fa-angle-right"></i></button>';if(oc.pageExtendBtnRightShow){var rc=oc.template.clone().addClass("pageExtendBtn pageExtendBtnDown");rc.append($("<i>").addClass("fa fa-angle-double-right"));pc+=rc.prop("outerHTML")}hc.requestData.pageNumberBtns=lc;pc+="</div>";if(ic.attr("showpagesize")!="false"){pc+='<div class="pagination-option">';pc+='<select class="btn btn-info btn-sm pageSizeSelect">';pc+='<option value="10">10条/页</option>';pc+='<option value="20">20条/页</option>';pc+='<option value="50">50条/页</option>';pc+='<option value="100">100条/页</option>';pc+="</select>";pc+="</div>"}if(ic.attr("showgo")!="false"){pc+='<div class="pagination-go">';pc+='到第&nbsp;<input type="text" oninput="value=value.replace(/[^\\d]/g,\'\')" placeholder="几" class="form-control input-sm redirectPageInput goPageId"/>页&nbsp;';pc+="<button class=\"btn btn-sm redirectPageBtn\" data-type='primary' normal>跳转</button>";pc+="</div>"}ic.find(".control").html(pc);var tc=ic.find(".pageIndexBtn");for(var sc=0;sc<tc.length;sc++){$(tc[sc]).click(function(){hc.gotoPage($(this).attr("pageNo"))})}ic.find(".pageExtendBtn.pageExtendBtnUp").prop("disabled",parseInt(tc.eq(0).attr("pageNo"))==1);ic.find(".pageExtendBtn.pageExtendBtnDown").prop("disabled",parseInt(tc.eq(tc.length-1).attr("pageNo"))==oc.totalPageAmount);ic.find(".pageExtendBtn").click(function(){if($(this).hasClass("pageExtendBtnUp")){var wc=oc.currentPageNo-oc.pageBtnShowAmount;wc=wc>1?wc:1;hc.gotoPage(wc)}else if($(this).hasClass("pageExtendBtnDown")){var wc=oc.currentPageNo+oc.pageBtnShowAmount;wc=wc<oc.totalPageAmount?wc:oc.totalPageAmount;hc.gotoPage(wc)}ic.find(".pageExtendBtn.pageExtendBtnUp").prop("disabled",parseInt(tc.eq(0).attr("pageNo"))==1);ic.find(".pageExtendBtn.pageExtendBtnDown").prop("disabled",parseInt(tc.eq(tc.length-1).attr("pageNo"))==oc.totalPageAmount)});ic.find(".pageSizeSelect").val(mc);if(kc<=1){ic.find(".prePageBtn").attr("disabled",true)}else{ic.find(".prePageBtn").attr("disabled",false)}if(kc>=lc){ic.find(".nextPageBtn").attr("disabled",true)}else{ic.find(".nextPageBtn").attr("disabled",false)}ic.find(".prePageBtn").click(function(){hc.prePage()});ic.find(".nextPageBtn").click(function(){hc.nextPage()});ic.find(".redirectPageBtn").click(function(){var xc=ic.find(".goPageId").val();if(xc==null||xc.trim()==""){RegionUtil.alert("Please input page number")}else{hc.gotoPage(xc)}});ic.find(".redirectPageInput").keypress(function(){if(event.keyCode==13){event.preventDefault();var yc=ic.find(".goPageId").val();if(yc==null||yc.trim()==""){RegionUtil.alert("请输入页码")}else{hc.gotoPage(yc)}}});ic.find(".pageSizeSelect").change(function(){hc.requestData.pageSize=$(this).val();hc.refreshRegion()});if(ic.attr("showinfo")!="false"){var uc=ic.find(".info");var vc='&nbsp;总共<span class="text-normal totalPageDis">0</span>页,<span class="text-normal totalAmountDis">0</span> <span class="text-normal">条记录</span>';uc.html(vc);uc.find(".totalAmountDis").html(jc);uc.find(".curPageDis").html(kc);uc.find(".totalPageDis").html(lc);uc.find(".pageSizeSelect").val(mc)}}};var DatepickerPlugin={specialDays:[],render:function(region,tmpObj,paraData){var width=tmpObj.attr("width");var noTodayBtn=tmpObj.attr("noTodayBtn");var onchange=tmpObj.attr("onchange");tmpObj.addClass("wrapped");var replaceHtml="<div class='calendar-wrapper region-wrapper'>"+tmpObj.prop("outerHTML");replaceHtml+='<div class="calendar-icon"><i class="fa-light fa-calendar-alt"></i></div>';replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);replaced.find(".calendar-icon").click(function(zc){var Ac=RS.getEventTarget(zc);$(Ac).closest(".region-wrapper").find(".wrapped").focus()});if(width!=null){replaced.css("width",width)}tmpObj=replaced.find(".wrapped");tmpObj.attr("onchange",onchange);var paraMap=new HashMap;if(tmpObj.hasClass("daterange")){RS.addDialog(tmpObj,"common/shared/date/core/rangedate-picker.rs",paraMap,function(Bc,Cc){Cc.put("minDate",Bc.attr("min-date"));Cc.put("maxDate",Bc.attr("max-date"));Cc.put("calStyle",Bc.attr("calStyle"));Cc.put("dateFormat",Bc.attr("format"));Cc.put("locale",Bc.attr("locale"));var Dc=Bc.val();if(Dc!=null){if(Dc.indexOf("~")!=-1){Dc=Dc.replaceAll(" ","");var Ec=Dc.split("~");if(Ec.length==2){Cc.put("startDate",Ec[0]);Cc.put("endDate",Ec[1])}}}},function(dialogRegion,targetInput){var onchange=targetInput.attr("onchange");dialogRegion.onRangeSelectEnd=function(date){targetInput.val(date.startDate+" ~ "+date.endDate);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)}})}else if(tmpObj.hasClass("datetime")){RS.addDialog(tmpObj,"common/shared/date/core/datetime-picker.rs",paraMap,function(Fc,Gc){var Hc=Fc.attr("dateFormat");if(Hc==null)Hc="YYYY-MM-DD";var Ic=Fc.attr("timeFormat");if(Ic==null)Ic="HH:mm";Gc.put("minDate",Fc.attr("min-date"));Gc.put("maxDate",Fc.attr("max-date"));Gc.put("calStyle",Fc.attr("calStyle"));Gc.put("dateFormat",Hc);Gc.put("timeFormat",Ic);Gc.put("locale",Fc.attr("locale"));var Jc=Fc.val();var Kc=moment(Jc,Hc+" "+Ic);if(Kc.isValid()){Gc.put("initDate",Kc.format(Hc));Gc.put("initTime",Kc.format(Ic))}},function(dialogRegion,targetInput){var onchange=targetInput.attr("onchange");dialogRegion.onOkClick=function(time){targetInput.val(time);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)};dialogRegion.onNowClick=function(time){targetInput.val(time);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)}})}else{paraMap.put("noTodayBtn",noTodayBtn);RS.addDialog(tmpObj,"common/shared/date/core/date-picker.rs",paraMap,function(Lc,Mc){Mc.put("minDate",Lc.attr("min-date"));Mc.put("maxDate",Lc.attr("max-date"));Mc.put("calStyle",Lc.attr("calStyle"));Mc.put("dateFormat",Lc.attr("format"));Mc.put("initDate",Lc.val());Mc.put("locale",Lc.attr("locale"))},function(dialogRegion,targetInput){var onchange=targetInput.attr("onchange");dialogRegion.onOkClick=function(date){targetInput.val(date);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)};dialogRegion.onNowClick=function(date){targetInput.val(date);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)};dialogRegion.onClearClick=function(date){targetInput.val("");if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)};dialogRegion.onDayClick=function(date){targetInput.val(date);if(onchange!=null&&onchange!=""){eval(onchange+".call(targetInput[0],targetInput.val())")}RS.tryCloseDialog(targetInput,0)}})}tmpObj.val(paraData);return tmpObj},updateVal:function(Nc,Oc,Pc,Qc){Pc.val(Qc)}};var FilePlugin={render:function(Rc,Sc,Tc){var Uc=Sc.hasClass("disabled");Sc.addClass("wrapped");Sc.addClass("hidden");Sc.attr("type","text");var Vc=Sc.prop("outerHTML");var Wc='<div class="file-wrapper region-wrapper">'+Vc;var Xc=Sc.attr("onUploaded");var Yc=Sc.attr("width");if(Yc==null)Yc="150px";var Zc="";var $c="";if(Array.prototype.isPrototypeOf(Tc)){for(var _c=0;_c<Tc.length;_c++){if(Tc[_c].fileId==null)Tc[_c].fileId=Tc[_c].id;if($c.length>0)$c+=","+Tc[_c].fileId;else $c+=Tc[_c].fileId;var a2=Tc[_c].fileKey.substring(Tc[_c].fileKey.lastIndexOf("/")+1,Tc[_c].fileKey.length);if(Uc)Zc+='<div class="file-view" file-id="'+Tc[_c].fileId+'"><div class="file-info" file-url="'+Tc[_c].url+'">'+a2+"</div></div>";else Zc+='<div class="file-view" file-id="'+Tc[_c].fileId+'"><div class="file-info" file-url="'+Tc[_c].url+'">'+a2+'</div><div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>'}}Wc+='<input type="file" class="hidden file-selector">';Wc+='\t<div class="uploaded-files">'+Zc+'<div class="brace"></div></div>';Wc+='\t<div class="plus-view">';Wc+='\t<div class="progress-cover hidden"><div class="file-info"></div><div class="progress-block"></div></div>';Wc+="\t</div>";if(!Uc){Wc+='<div class="ctrols"><i class="attach-btn fa fa-plus fa-lg" ></i>';Wc+='<i class="cancel-btn hidden fa fa-stop fa-lg" ></i>';Wc+="</div>"}Wc+="</div>";var b2=$(Wc);RegionUtil.addRegionUniqueId(b2[0],Rc.regionId);Sc.replaceWith(b2);Sc=b2.find(".wrapped");Sc.val($c);var c2=b2.find(".file-selector");var d2=new FileUploader(b2,Sc,c2,Xc);b2.attr("uploader",d2.id);if(Rc.uploaders==null){Rc.uploaders={}}Rc.uploaders[d2.id]=d2;return Sc},updateVal:function(e2,f2,g2,h2){var i2=g2.hasClass("disabled");f2.find(".uploaded-files>.file-view").remove();var j2="";if(Array.prototype.isPrototypeOf(h2)&&h2.length>0){var k2="";if(Array.prototype.isPrototypeOf(h2)){for(var l2=0;l2<h2.length;l2++){if(h2[l2].fileId==null)h2[l2].fileId=h2[l2].id;if(j2.length>0)j2+=","+h2[l2].fileId;else j2+=h2[l2].fileId;var m2=h2[l2].fileKey.substring(h2[l2].fileKey.lastIndexOf("/")+1,h2[l2].fileKey.length);if(i2)k2+='<div class="file-view" file-id="'+h2[l2].fileId+'"><div class="file-info" file-url="'+h2[l2].url+'">'+m2+"</div></div>";else k2+='<div class="file-view" file-id="'+h2[l2].fileId+'"><div class="file-info" file-url="'+h2[l2].url+'">'+m2+'</div><div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>'}}RegionUtil.insertBefore(e2,f2.find(".uploaded-files>.brace")[0],k2);var n2=f2.attr("uploader");e2.uploaders[n2].initWithExsitData()}g2.val(j2)}};var ImgPlugin={render:function(o2,p2,q2){var r2=p2.hasClass("disabled");p2.addClass("wrapped");p2.addClass("hidden");p2.attr("type","text");var s2=p2.prop("outerHTML");var t2='<div class="img-wrapper region-wrapper">'+s2;var u2=p2.attr("camera");var v2=p2.attr("onUploaded");var w2=p2.attr("width");if(w2==null)w2="150px";var x2=p2.attr("hint");var y2="";var z2="";if(Array.prototype.isPrototypeOf(q2)){for(var A2=0;A2<q2.length;A2++){if(q2[A2].fileId==null)q2[A2].fileId=q2[A2].id;if(z2.length>0)z2+=","+q2[A2].fileId;else z2+=q2[A2].fileId;var B2=q2[A2].fileKey.substring(q2[A2].fileKey.lastIndexOf("/")+1,q2[A2].fileKey.length);if(r2)y2+='<div class="img-view" file-id="'+q2[A2].fileId+'"><img class="preview lazyImg" data-original="'+q2[A2].url+'"><div class="delete-btn hidden"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>';else y2+='<div class="img-view" file-id="'+q2[A2].fileId+'"><img class="preview lazyImg" data-original="'+q2[A2].url+'"><div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>'}}if(u2=="true")t2+='<input type="file" capture="camera" accept="image/*" class="hidden file-selector">';else t2+='<input type="file" accept="image/*" class="hidden file-selector">';t2+='\t<div class="uploaded-imgs">'+y2+'<div class="brace"></div></div>';if(!r2){t2+='\t<div class="plus-view attach-btn">';t2+='\t<div class="plus-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 32 32" width="18" height="18" style="fill: rgba(0, 0, 0, 0.45);"><path d="M29.714 15.086h-12.8v-12.8h-2.286v12.8h-12.57v2.286h12.571v12.57h2.286v-12.57h12.8z"></path></svg></div>';if(x2!=null){t2+='\t<div class="hint">'+x2+"</div>"}else{if(u2=="true")t2+='\t<div class="hint">拍照</div>';else t2+='\t<div class="hint">上传照片</div>'}t2+='\t<div class="progress-cover hidden"><div class="progress-block"></div></div>';t2+='\t<div class="img-view hidden"><img class="preview"></div>';t2+="\t</div>"}t2+='<div class="ctrols">';t2+='<i class="cancel-btn hidden fa fa-stop fa-lg"></i>';t2+="</div>";t2+="</div>";var C2=$(t2);RegionUtil.addRegionUniqueId(C2[0],o2.regionId);p2.replaceWith(C2);p2=C2.find(".wrapped");if(r2)C2.addClass("disabled");p2.val(z2);var D2=C2.find(".file-selector");D2.attr("file-type","image");var E2=new FileUploader(C2,p2,D2,v2);C2.attr("uploader",E2.id);if(o2.uploaders==null){o2.uploaders={}}o2.uploaders[E2.id]=E2;return p2},updateVal:function(F2,G2,H2,I2){var J2=G2.hasClass("disabled");G2.find(".uploaded-imgs>.img-view").remove();var K2="";if(Array.prototype.isPrototypeOf(I2)&&I2.length>0){var L2="";if(Array.prototype.isPrototypeOf(I2)){for(var M2=0;M2<I2.length;M2++){if(I2[M2].fileId==null)I2[M2].fileId=I2[M2].id;if(K2.length>0)K2+=","+I2[M2].fileId;else K2+=I2[M2].fileId;var N2=I2[M2].fileKey.substring(I2[M2].fileKey.lastIndexOf("/")+1,I2[M2].fileKey.length);if(J2)L2+='<div class="img-view" file-id="'+I2[M2].fileId+'"><img class="preview lazyImg" data-original="'+I2[M2].url+'"><div class="hidden delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>';else L2+='<div class="img-view" file-id="'+I2[M2].fileId+'"><img class="preview lazyImg" data-original="'+I2[M2].url+'"><div class="delete-btn"><svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg></div></div>'}}RegionUtil.insertBefore(F2,G2.find(".uploaded-imgs>.brace")[0],L2);var O2=G2.attr("uploader");F2.uploaders[O2].initWithExsitData();if(Config.lazyLoadImg&&I2.length>0){window.setTimeout(function(){F2.find(".lazyImg").lazyload({placeholder:"images/loading.gif",threshold:200,effect:"fadeIn",container:G2})},10)}}H2.val(K2)},view:function(P2,Q2,R2){}};var DropdownPlugin={render:function(S2,T2,U2){var V2=T2.attr("onchange");if(V2==null)V2="";var W2=T2[0].className;var X2=T2.hasClass("disabled");var Y2=T2.hasClass("region-searchable");var Z2=T2.attr("width");var $2=T2.hasClass("inner");T2.addClass("wrapped");var _2=T2.attr("region-ds");var ad=RegionUtil.getRegionDsList(S2,_2);var bd=U2;if(bd==null)bd="";var cd=DropdownPlugin.getOptionsObject(ad,bd,T2,null);var dd=cd.optionsHtml;var ed=cd.selectedValueDesc;var fd=T2.attr("region-attr");var gd=RegionUtil.getUUID();var hd='<div class="dropdown-wrapper region-wrapper"><input type="hidden" onchange="'+V2+'" region-ds="'+_2+'" region-attr="'+fd;if(Y2)hd+='" class="wrapped region-searchable">';else hd+='" class="wrapped">';hd+='<input type="text" readonly="readonly" class="shown form-control"><div class="select-icon"><i class="fa-solid fa-chevron-down"></i></div><ul class="options messageoptions" style="display:none;width:max-content;">';hd+=dd;hd+="</ul></div>";var id=$(hd);id.insertAfter(T2);RegionUtil.addRegionUniqueId(id[0],S2.regionId);if(X2){id.addClass("disabled");id.find(".shown").addClass("disabled")}T2.remove();if(Z2!=null){id.css("width",Z2);id.find("input[type='text']").css("width",Z2)}setTimeout(function(){var md=id.find("input[type='text']").outerWidth(true);if(md==0)md=id.css("width");id.find("ul").css("min-width",md)});id.resize(function(){id.find(".messageoptions").css("min-width",id.find("input[type='text']").outerWidth(true))});var jd=id.find(".wrapped");jd.val(bd);var kd=id;if(ed!=null)kd.find("input[type='text']").val(ed);kd.attr("wrapper-id",gd);var ld=S2;if(S2.isInGrid){ld=S2.parent}if(ld.selectFunctions==null)ld.selectFunctions={};ld.selectFunctions[gd+"_readyHideMenu"]=function(){setTimeout(function(){var nd=kd.attr("ot");var od=kd.attr("oc");if((nd==null||nd==0)&&(od==null||od==0)){kd.find("ul").slideUp(100);kd.attr("shown",0)}},20)};DropdownPlugin.addEventListenerForOptions(kd);kd.click(function(){var pd=T2.attr("region-ds");var qd=RegionUtil.getRegionDsList(S2,pd);var rd=34.5*qd.length;if(rd>185)rd=185;var sd=1;var td=window.event||arguments.callee.caller.arguments[0];var ud=kd.closest(".cover-window");var vd;var wd;if(ud.length==1){vd=ud.outerHeight(true)+ud[0].offsetTop-td.clientY-kd.outerHeight(true);wd=RegionUtil.getDomPosition(kd[0]).y-RegionUtil.getDomPosition(ud[0]).y}else{vd=document.body.clientHeight-td.clientY-kd.outerHeight(true);wd=RegionUtil.getDomPosition(kd[0]).y}if(wd<vd)vd=rd;if(vd<rd){sd=2}var xd=kd.attr("shown");if(xd==null||xd==0){kd.attr("ot",1);kd.attr("shown",1);if(sd==2){DropdownPlugin.showOptionsAtTop(kd,rd)}else{DropdownPlugin.showOptionsAtBottom(kd,rd)}}else{kd.attr("ot",0);ld.selectFunctions[kd.attr("wrapper-id")+"_readyHideMenu"]()}});kd.find("input[type='text']").mouseover(function(){if(kd.attr("shown")==1)kd.attr("ot",1)});kd.find("input[type='text']").mouseout(function(){if(kd.attr("shown")==1){kd.attr("ot",0);ld.selectFunctions[kd.attr("wrapper-id")+"_readyHideMenu"]()}});kd.find(".options").mouseover(function(){kd.attr("oc",1);kd.attr("ot",0)});kd.find(".options").mouseout(function(){kd.attr("oc",0);ld.selectFunctions[kd.attr("wrapper-id")+"_readyHideMenu"]()});if($2)kd.find(".wrapped").addClass("inner");return kd.find(".wrapped")},showOptionsAtTop:function(yd,zd){var Ad=yd.find("ul");if(!Ad.hasClass("option-top")){yd.find("li").remove().each(function(){Ad.prepend($(this))});Ad.addClass("option-top");Ad.css("top",-zd-5);DropdownPlugin.addEventListenerForOptions(yd)}Ad.show(100)},showOptionsAtBottom:function(Bd,Cd){var Dd=Bd.find("ul");if(Dd.hasClass("option-top")){Bd.find("li").remove().each(function(){Dd.prepend($(this))});Dd.removeClass("option-top");Dd.css("top",Bd.outerHeight(true));DropdownPlugin.addEventListenerForOptions(Bd)}Dd.slideDown(100)},addEventListenerForOptions:function(selectWrapper){var targetInput=selectWrapper.find(".wrapped");var onchange=targetInput.attr("onchange");var region=RegionUtil.getRegionByElem(selectWrapper[0]);selectWrapper.find("li").click(function(){selectWrapper.find("li").removeClass("selected");$(this).addClass("selected");selectWrapper.attr("oc",0);region.selectFunctions[selectWrapper.attr("wrapper-id")+"_readyHideMenu"]();var currentVal=targetInput.val();var newVal=this.getAttribute("val");if(currentVal!=newVal){var input=selectWrapper.find("input[type='text']");input.val($(this).text());targetInput.val(this.getAttribute("val"));if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newVal)")}}})},getOptionsObject:function(Ed,Fd,Gd,Hd){var Id=null;var Jd="";Gd.find("option").each(function(){if(Fd==$(this).val()){Jd+="<li class='selected' val='"+$(this).val()+"'><font class='label-txt'>"+$(this).text()+"</font></li>";Id=$(this).text()}else{Jd+="<li val='"+$(this).val()+"'><font class='label-txt'>"+$(this).text()+"</font></li>"}});if(Hd!=null){if(Fd==null||Fd==""){Jd+="<li class='selected' val=''><font class='label-txt'>请选择</font></li>";Id="请选择"}else{Jd+="<li val=''><font class='label-txt'>请选择</font></li>"}}if(Ed!=null){for(var Kd=0;Kd<Ed.length;Kd++){if(Fd==Ed[Kd].value){Jd+="<li class='selected' val='"+Ed[Kd].value+"'><font class='label-txt'>"+Ed[Kd].text+"</font></li>";Id=Ed[Kd].text}else{Jd+="<li val='"+Ed[Kd].value+"'><font class='label-txt'>"+Ed[Kd].text+"</font></li>"}}}if(Hd!=null){if(Id!=null){Hd.find("input[type='text']").val(Id)}else{Hd.find("input[type='text']").val("请选择")}}return{optionsHtml:Jd,selectedValueDesc:Id}},refreshDataSource:function(Ld,Md,Nd,Od){var Pd=Nd.val();var Qd=null;var Rd=Md;var Sd=DropdownPlugin.getOptionsObject(Od,Pd,Nd,Md);var Td=Sd.optionsHtml;var Ud=Sd.selectedValueDesc;Rd.find(".options").html(Td);RegionUtil.addRegionUniqueId(Rd[0],Ld.regionId);DropdownPlugin.addEventListenerForOptions(Rd)},updateVal:function(Vd,Wd,Xd,Yd){if(Yd==null)Yd="";else Yd+="";Xd.val(Yd);Wd.find(".options").find("li").each(function(){if(Yd==$(this).attr("val")){var Zd=Wd.find("input[type='text']");Zd.val($(this).find(".label-txt").text());return false}})}};var MultiDropdownPlugin={render:function(region,selectObj,paraData){var onchange=selectObj.attr("onchange");if(onchange==null)onchange="";var placeholder=selectObj.attr("placeholder");var isDisabled=selectObj.hasClass("disabled");var searchAble=selectObj.hasClass("region-searchable");var width=selectObj.attr("width");var isInner=selectObj.hasClass("inner");var regionDsName=selectObj.attr("region-ds");var options=RegionUtil.getRegionDsList(region,regionDsName);if(paraData==null)paraData="";else paraData=paraData+"";var optionsHtml="";if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=null;if(paraData!="")currentValueArray=paraData.split(",");selectObj.find("option").each(function(){optionsHtml+="<li val='"+$(this).val()+"'><input class='checkitem' type=\"checkbox\"><font class='label-txt'>"+$(this).text()+"</font></li>"});if(options!=null){for(var i=0;i<options.length;i++){optionsHtml+="<li val='"+options[i].value+"'><input class='checkitem' type=\"checkbox\"><font class='label-txt'>"+options[i].text+"</font></li>"}}var regionAttr=selectObj.attr("region-attr");var uuid=RegionUtil.getUUID();var codeTemplate='<div class="m-dropdown-wrapper region-wrapper"><input type="hidden" onchange="'+onchange+'" region-ds="'+regionDsName+'" region-attr="'+regionAttr;if(searchAble)codeTemplate+='" class="wrapped region-searchable">';else codeTemplate+='" class="wrapped">';codeTemplate+='<div readonly="readonly" class="item-container"><div class="selectedItems shown">   </div></div>';codeTemplate+='<div class="select-icon-wrap"><div class="select-icon"><i class="fa-solid fa-lg fa-chevron-down"></i></div></div><ul class="options messageoptions" style="display:none">';codeTemplate+=optionsHtml;codeTemplate+="</ul></div>";var replaced=$(codeTemplate);replaced.insertAfter(selectObj);if(isDisabled){replaced.addClass("disabled");replaced.find(".shown").addClass("disabled")}var selectWrapper=replaced;if(placeholder!=null)selectWrapper.attr("placeholder",placeholder);setTimeout(function(){if(width!=null)selectWrapper.find(".item-container").css("width",width)});if(currentValueArray!=null&&currentValueArray.length>0){var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}var initCheckItems=selectWrapper.find(".checkitem");var selectedItems=selectWrapper.find(".selectedItems");if(placeholder!=null){var selectedItems=selectWrapper.find(".selectedItems");selectedItems.html("<div class='placeholder hidden'>"+placeholder+"</div>")}else{selectedItems.html("")}initCheckItems.each(function(){var initCheckItem=$(this);var tmpLiobj=initCheckItem.parent();var value=tmpLiobj.attr("val");if(valueCache[value]){initCheckItem.prop("checked",true);var labelTxt=tmpLiobj.find(".label-txt").text();selectedItems.append("<div val='"+value+"' class=\"value_"+value+' selected">'+labelTxt+'<div class="itemclose">&nbsp;</div></div>');selectWrapper.find(".itemclose").click(function(evt){var parentDivObj=$(this).parent();var tmpValue=parentDivObj.attr("val");selectWrapper.find(".options").find("li").each(function(){if(tmpValue==$(this).attr("val")){$(this).find(".checkitem").prop("checked",false);return false}});parentDivObj.remove();var newValue=MultiDropdownPlugin.calculateValFunc(selectWrapper);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}evt.stopPropagation()})}})}else{if(placeholder!=null){var selectedItems=selectWrapper.find(".selectedItems");selectedItems.html("<div class='placeholder'>"+placeholder+"</div>")}}RegionUtil.addRegionUniqueId(replaced[0],region.regionId);selectObj.remove();if(width!=null){selectWrapper.css("width",width)}var targetInput=selectWrapper.find(".wrapped");targetInput.val(paraData);selectWrapper.attr("wrapper-id",uuid);var targetRegion=region;if(region.isInGrid){targetRegion=region.parent}if(targetRegion.selectFunctions==null)targetRegion.selectFunctions={};targetRegion.selectFunctions[uuid+"_readyHideMenu"]=function(){setTimeout(function(){var $d=selectWrapper.attr("ot");var _d=selectWrapper.attr("oc");if(($d==null||$d==0)&&(_d==null||_d==0)){selectWrapper.find("ul").slideUp(200);selectWrapper.attr("shown",0)}},20)};MultiDropdownPlugin.addEventListenerForOptions(selectWrapper);selectWrapper.click(function(){var a3=selectObj.attr("region-ds");var b3=RegionUtil.getRegionDsList(region,a3);var c3=34.5*b3.length;if(c3>185)c3=185;var d3=1;var e3=window.event||arguments.callee.caller.arguments[0];var f3=selectWrapper.closest(".cover-window");var g3;var h3;if(f3.length==1){g3=f3.outerHeight(true)+f3[0].offsetTop-e3.clientY-selectWrapper.outerHeight(true);h3=RegionUtil.getDomPosition(selectWrapper[0]).y-RegionUtil.getDomPosition(f3[0]).y}else{g3=document.body.clientHeight-e3.clientY-selectWrapper.outerHeight(true);h3=RegionUtil.getDomPosition(selectWrapper[0]).y}if(h3<g3)g3=c3;if(g3<c3){d3=2}var i3=selectWrapper.attr("shown");if(i3==null||i3==0){selectWrapper.attr("ot",1);selectWrapper.attr("shown",1);if(d3==2){MultiDropdownPlugin.showOptionsAtTop(selectWrapper,c3)}else{MultiDropdownPlugin.showOptionsAtBottom(selectWrapper,c3)}}else{selectWrapper.attr("ot",0);targetRegion.selectFunctions[selectWrapper.attr("wrapper-id")+"_readyHideMenu"]()}});selectWrapper.find("input[type='text']").mouseover(function(){if(selectWrapper.attr("shown")==1)selectWrapper.attr("ot",1)});selectWrapper.find(".item-container").mouseout(function(){if(selectWrapper.attr("shown")==1){selectWrapper.attr("ot",0);targetRegion.selectFunctions[selectWrapper.attr("wrapper-id")+"_readyHideMenu"]()}});selectWrapper.find(".options").mouseover(function(){selectWrapper.attr("oc",1);selectWrapper.attr("ot",0)});selectWrapper.find(".options").mouseout(function(){selectWrapper.attr("oc",0);targetRegion.selectFunctions[selectWrapper.attr("wrapper-id")+"_readyHideMenu"]()});if(isInner)selectWrapper.find(".wrapped").addClass("inner");return selectWrapper.find(".wrapped")},relocateIcon:function(j3){setTimeout(function(){j3.find(".select-icon-wrap").css("line-height",j3.outerHeight()+"px")})},showOptionsAtTop:function(k3,l3){var m3=k3.find("ul");if(!m3.hasClass("option-top")){k3.find("li").remove().each(function(){m3.prepend($(this))});m3.addClass("option-top");m3.css("top",-l3-5);MultiDropdownPlugin.addEventListenerForOptions(k3)}m3.show(100)},showOptionsAtBottom:function(n3,o3){var p3=n3.find("ul");if(p3.hasClass("option-top")){n3.find("li").remove().each(function(){p3.prepend($(this))});p3.removeClass("option-top");p3.css("top",n3.outerHeight(true));MultiDropdownPlugin.addEventListenerForOptions(n3)}p3.slideDown(100)},addEventListenerForOptions:function(selectWrapper){selectWrapper.find(".checkitem").click(function(){var onchange=selectWrapper.find(".wrapped").attr("onchange");var ischecked=$(this).prop("checked");var selectedItems=selectWrapper.find(".selectedItems");var liObj=$(this).closest("li");var value=liObj.attr("val");if(ischecked){var labelTxt=liObj.find(".label-txt").text();selectedItems.append("<div val='"+value+"' class=\"value_"+value+' selected">'+labelTxt+'<div class="itemclose">&nbsp;</div></div>');selectWrapper.find(".itemclose").click(function(evt){var parentDivObj=$(this).parent();var tmpValue=parentDivObj.attr("val");selectWrapper.find(".options").find("li").each(function(){if(tmpValue==$(this).attr("val")){$(this).find(".checkitem").prop("checked",false);return false}});parentDivObj.remove();var newValue=MultiDropdownPlugin.calculateValFunc(selectWrapper);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}evt.stopPropagation()})}else{selectedItems.find(".value_"+value).remove()}var newValue=MultiDropdownPlugin.calculateValFunc(selectWrapper);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}})},calculateValFunc:function(q3){var r3="";q3.find(".checkitem").each(function(){if($(this).prop("checked")){if(r3.length==0)r3+=$(this).closest("li").attr("val");else r3+=","+$(this).closest("li").attr("val")}});q3.find(".wrapped").val(r3);var s3=q3.find(".selectedItems>.selected").length;if(s3==0){q3.find(".selectedItems>.placeholder").removeClass("hidden")}else{q3.find(".selectedItems>.placeholder").addClass("hidden")}MultiDropdownPlugin.relocateIcon(q3);return r3},refreshDataSource:function(region,wrapperElemObj,regionElemObj,options){var paraData=regionElemObj.val();var onchange=regionElemObj.attr("onchange");var placeholder=wrapperElemObj.attr("placeholder");var selectWrapper=wrapperElemObj;var optionsHtml="";if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=null;if(paraData!="")currentValueArray=paraData.split(",");if(options!=null){for(var i=0;i<options.length;i++){optionsHtml+="<li val='"+options[i].value+"'><input class='checkitem' type=\"checkbox\"><font class='label-txt'>"+options[i].text+"</font></li>"}}selectWrapper.find(".options").html(optionsHtml);RegionUtil.addRegionUniqueId(selectWrapper[0],region.regionId);if(currentValueArray!=null&&currentValueArray.length>0){var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}var initCheckItems=selectWrapper.find(".checkitem");var selectedItems=selectWrapper.find(".selectedItems");selectedItems.html("");initCheckItems.each(function(){var initCheckItem=$(this);var tmpLiobj=initCheckItem.parent();var value=tmpLiobj.attr("val");if(valueCache[value]){initCheckItem.prop("checked",true);var labelTxt=tmpLiobj.find(".label-txt").text();selectedItems.append("<div val='"+value+"' class=\"value_"+value+' selected">'+labelTxt+'<div class="itemclose">&nbsp;</div></div>');selectWrapper.find(".itemclose").click(function(evt){var parentDivObj=$(this).parent();var tmpValue=parentDivObj.attr("val");selectWrapper.find(".options").find("li").each(function(){if(tmpValue==$(this).attr("val")){$(this).find(".checkitem").prop("checked",false);return false}});parentDivObj.remove();var newValue=MultiDropdownPlugin.calculateValFunc(selectWrapper);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}evt.stopPropagation()})}})}else{if(placeholder!=null){var selectedItems=selectWrapper.find(".selectedItems");selectedItems.html("<div class='placeholder'>"+placeholder+"</div>")}}MultiDropdownPlugin.addEventListenerForOptions(selectWrapper)},updateVal:function(t3,u3,v3,w3){if(w3==null)w3="";v3.val(w3);var x3=v3.attr("region-ds");var y3=RegionUtil.getRegionDsList(t3,x3);MultiDropdownPlugin.refreshDataSource(t3,u3,v3,y3)}};var MultiSelectPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var isDisabled=tmpObj.hasClass("disabled");var regionDsName=tmpObj.attr("region-ds");var regionAttr=tmpObj.attr("region-attr");var className=tmpObj[0].className+" wrapped";var options=RegionUtil.getRegionDsList(region,regionDsName);if(paraData==null)paraData="";var optionsHtml="";paraData+="";if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=paraData.split(",");var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}tmpObj.find("option").each(function(){optionsHtml+="<li val='"+$(this).val()+"'><input class='checkitem' type=\"checkbox\"><font class='label-txt'>"+$(this).text()+"</font></li>"});var width=tmpObj.attr("width");var height=tmpObj.attr("height");if(width==null||width=="")width="500px";if(height==null||height=="")height="200px";var replaceHtml='<div class="multiselect-wrapper region-wrapper">';replaceHtml+='<input type="hidden" class="'+className+'" region-ds="'+regionDsName+'" region-attr="'+regionAttr+'" onchange="'+onchange+'">';replaceHtml+='\t<div class="options-panel">';replaceHtml+='\t\t<div class="options scroll-bar1">';tmpObj.find("option").each(function(){replaceHtml+='<li><input class="checkitem" type="checkbox" value="'+$(this).val()+'"><span>'+$(this).text()+"</span></li>"});if(options!=null){for(var i=0;i<options.length;i++){replaceHtml+='<li><input class="checkitem" type="checkbox" value="'+options[i].value+'"><span>'+options[i].text+"</span></li>"}}replaceHtml+="\t\t</div>";replaceHtml+="\t</div>";replaceHtml+="</div>";var selectWrapper=$(replaceHtml);RegionUtil.addRegionUniqueId(selectWrapper[0],region.regionId);selectWrapper.css("width",width);selectWrapper.css("height",height);tmpObj.replaceWith(selectWrapper);if(isDisabled){selectWrapper.addClass("disabled")}var initCheckItems=selectWrapper.find(".checkitem");initCheckItems.each(function(){var z3=$(this).val();if(valueCache[z3])$(this).prop("checked",true)});selectWrapper.find(".checkitem").click(function(){var checkItems=selectWrapper.find(".checkitem");var newValue="";checkItems.each(function(){if($(this).prop("checked")){if(newValue=="")newValue+=$(this).val();else newValue+=","+$(this).val()}});selectWrapper.find(".wrapped").val(newValue);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}});tmpObj=selectWrapper.find(".wrapped");tmpObj.val(paraData);return tmpObj},refreshDataSource:function(region,wrapperElemObj,regionElemObj,options){var paraData=regionElemObj.val();var onchange=regionElemObj.attr("onchange");var selectWrapper=wrapperElemObj;var optionsHtml="";if(options!=null){for(var i=0;i<options.length;i++){optionsHtml+='<li><input class="checkitem" type="checkbox" value="'+options[i].value+'"><span>'+options[i].text+"</span></li>"}}selectWrapper.find(".options").html(optionsHtml);RegionUtil.addRegionUniqueId(selectWrapper[0],region.regionId);selectWrapper.find(".checkitem").click(function(){var checkItems=selectWrapper.find(".checkitem");var newValue="";checkItems.each(function(){if($(this).prop("checked")){if(newValue=="")newValue+=$(this).val();else newValue+=","+$(this).val()}});selectWrapper.find(".wrapped").val(newValue);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newValue)")}});if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=paraData.split(",");var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}var newValue="";var initCheckItems=selectWrapper.find(".checkitem");initCheckItems.each(function(){var A3=$(this).val();if(valueCache[A3]){$(this).prop("checked",true);if(newValue=="")newValue+=$(this).val();else newValue+=","+$(this).val()}});regionElemObj.val(newValue)},updateVal:function(B3,C3,D3,E3){D3.val(E3);if(E3==null)E3="";else E3+="";if(E3.endWith(",")){E3=E3.substring(0,E3.length-1)}var F3=E3.split(",");var G3={};for(var H3=0;H3<F3.length;H3++){G3[F3[H3]]=true}C3.find(".checkitem").each(function(){var I3=$(this);if(G3[I3.val()])I3.prop("checked",true);else I3.prop("checked",false)})}};var StarPlugin={render:function(region,tmpObj,paraData){var maxScore=tmpObj.attr("max-score");if(maxScore==null)maxScore=5;else maxScore=parseInt(maxScore);tmpObj.addClass("wrapped");tmpObj.attr("type","hidden");var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var hiddenInputHtml=tmpObj.prop("outerHTML");var starNum=0;if(paraData==null)starNum=0;else starNum=parseInt(paraData);var replaceHtml='<div class="star-wrapper region-wrapper">'+hiddenInputHtml;for(var i=0;i<maxScore;i++,starNum--){if(starNum>0)replaceHtml+='<i class="fa fa-star" num="'+i+'"></i>';else replaceHtml+='<i class="fa fa-light fa-star" num="'+i+'"></i>'}replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);replaced.find("i").click(function(){var newScore=$(this).attr("num");newScore=parseInt(newScore)+1;var starsArray=replaced.find("i");replaced.find(".star").val(newScore);for(var i=0;i<starsArray.length;i++,newScore--){if(newScore>0){$(starsArray[i]).removeClass("fa-light fa-star");$(starsArray[i]).addClass("fa-star")}else{$(starsArray[i]).removeClass("fa-star");$(starsArray[i]).addClass("fa-light fa-star")}}if(onchange!=null&&onchange!=""){eval(onchange+".call(replaced,newScore)")}});tmpObj=replaced.find(".star");tmpObj.val(paraData);return tmpObj},updateVal:function(J3,K3,L3,M3){L3.val(M3);var N3=K3.find("i");var O3=M3;for(var P3=0;P3<N3.length;P3++,O3--){if(O3>0){$(N3[P3]).removeClass("fa-light fa-star");$(N3[P3]).addClass("fa-star")}else{$(N3[P3]).removeClass("fa-star");$(N3[P3]).addClass("fa-light fa-star")}}}};var SwitchPlugin={render:function(region,tmpObj,paraData){tmpObj.attr("type","hidden");tmpObj.addClass("wrapped");var activeText=tmpObj.attr("active-text");var inactiveText=tmpObj.attr("inactive-text");var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var hiddenInputHtml=tmpObj.prop("outerHTML");if(paraData==null||paraData=="")paraData=0;else paraData=parseInt(paraData);var replaceHtml='<div class="switch-wrapper region-wrapper">'+hiddenInputHtml;if(inactiveText!=null)replaceHtml+='<div class="inactive-text">'+inactiveText+"</div>";replaceHtml+='<div class="switch-wrapper-btn">';replaceHtml+='<div class="switch-btn"></div>';replaceHtml+="</div>";if(activeText!=null)replaceHtml+='<div class="active-text">'+activeText+"</div>";replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);var btn_wrapper=replaced.find(".switch-wrapper-btn");setTimeout(function(){if(paraData!=null&&paraData!=""&&parseInt(paraData)==1){btn_wrapper.addClass("switch-actived");var Q3=replaced.find(".switch-btn");var R3=btn_wrapper.width();var S3=Q3.outerWidth(true);replaced.find(".switch-btn").css("left",R3-S3+"px")}});btn_wrapper.click(function(event){var newVal=0;if(btn_wrapper.hasClass("switch-actived")){replaced.find(".switch-btn").animate({left:"0px"},200);btn_wrapper.removeClass("switch-actived");replaced.find(".switch").val(newVal)}else{btn_wrapper.addClass("switch-actived");var swtichBtn=replaced.find(".switch-btn");var width1=btn_wrapper.width();var width2=swtichBtn.outerWidth(true);replaced.find(".switch-btn").animate({left:width1-width2+"px"},200);newVal=1;replaced.find(".switch").val(newVal)}if(onchange!=null&&onchange!=""){var indexTag=onchange.indexOf("(");if(indexTag==-1){eval(onchange+".call(btn_wrapper,newVal,event)")}else{var script=onchange.substring(0,indexTag)+".call(btn_wrapper,newVal,event"+onchange.substring(indexTag+1,onchange.length);eval(script)}}});tmpObj=replaced.find(".switch");tmpObj.val(paraData);return tmpObj},updateVal:function(T3,U3,V3,W3){V3.val(W3);var X3=U3.find(".switch-wrapper-btn");if(W3+""=="0"){if(X3.hasClass("switch-actived")){U3.find(".switch-btn").animate({left:"0px"},200);X3.removeClass("switch-actived")}}else{if(!X3.hasClass("switch-actived")){X3.addClass("switch-actived");var Y3=U3.find(".switch-btn");var Z3=X3.width();var $3=Y3.outerWidth(true);U3.find(".switch-btn").animate({left:Z3-$3+"px"},200);U3.find(".switch").val(1)}}}};var TransferPlugin={render:function(_3,ae,be){ae.attr("type","hidden");ae.addClass("wrapped");var ce=ae.attr("width");var de=ae.attr("height");if(ce==null||ce=="")ce="500px";if(de==null||de=="")de="200px";var ee=ae.prop("outerHTML");var fe=[];var ge=[];var he=_3.getAttrConfig([ae.attr("region-attr")]);if(he==null)he=_3.regionData[ae.attr("region-attr")+"List"];if(he!=null){var ie=null;if(be!=null)ie=be.split(",");var je={};if(ie!=null){for(var ke=0;ke<ie.length;ke++){je[ie[ke]]=true}}for(var ke=0;ke<he.length;ke++){var le=he[ke];if(je[le["value"]]){ge.push(le)}else{fe.push(le)}}}var me=fe.length;var ne=ge.length;var oe='<div class="transfer-wrapper region-wrapper">'+ee;oe+='\t<div class="source transfer-panel">';oe+='\t\t<div class="header">';oe+='\t\t\t<li><input class="checkAll" type="checkbox""><span>'+ae.attr("source-title")+'</span><span class="summary">0/'+me+"</span></li>";oe+="\t\t</div>";oe+='\t\t<div class="body scroll-bar1">';if(me>0){var pe=fe;for(var ke=0;ke<pe.length;ke++){oe+='<li><input class="checkitem" type="checkbox" value="'+pe[ke].value+'"><span>'+pe[ke].text+"</span></li>"}}oe+="\t\t</div>";oe+="\t</div>";oe+='\t<div class="control">';oe+='\t\t<div class="trans-btns">';oe+='\t\t\t<div><i class="trans-btn trans-right fa-solid fa-arrow-right"></i></div>';oe+='\t\t\t<div><i class="trans-btn trans-left fa-solid fa-arrow-left"></i></div>';oe+="\t\t</div>";oe+="\t</div>";oe+='\t<div class="result transfer-panel">';oe+='\t\t<div class="header">';oe+='\t\t\t<li><input class="checkAll" type="checkbox"><span>'+ae.attr("result-title")+'</span><span class="summary">0/'+ne+"</span></li>";oe+="\t\t</div>";oe+='\t\t<div class="body scroll-bar1">';if(ne>0){var pe=ge;for(var ke=0;ke<pe.length;ke++){oe+='<li><input class="checkitem" type="checkbox" value="'+pe[ke].value+'"><span>'+pe[ke].text+"</span></li>"}}oe+="\t\t</div>";oe+="\t</div>";oe+="</div>";var qe=$(oe);RegionUtil.addRegionUniqueId(qe[0],_3.regionId);qe.css("width",ce);qe.css("height",de);qe.find(".control").css("line-height",de);ae.replaceWith(qe);var re=qe.find(".source");re.find(".checkAll").click(function(){var te=$(this).prop("checked");var ue=re.find(".checkitem");ue.prop("checked",te);var ve=ue.length;if(te)re.find(".summary").text(ve+"/"+ve);else re.find(".summary").text("0/"+ve)});re.find(".checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});re.find("li").click(function(){var we=$(this).find(".checkitem");if(we.prop("checked"))we.prop("checked",false);else we.prop("checked",true);TransferPlugin.recalculateSourcePart(re)});var se=qe.find(".result");se.find(".checkAll").click(function(){var xe=$(this).prop("checked");var ye=se.find(".checkitem");ye.prop("checked",xe);var ze=ye.length;if(xe)se.find(".summary").text(ze+"/"+ze);else se.find(".summary").text("0/"+ze)});se.find(".checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});se.find("li").click(function(){var Ae=$(this).find(".checkitem");if(Ae.prop("checked"))Ae.prop("checked",false);else Ae.prop("checked",true);TransferPlugin.recalculateResultPart(se)});qe.find(".trans-right").click(function(){var Be=re.find(".checkitem");var Ce="";Be.each(function(){if($(this).prop("checked")){var De=$(this).parent();De.remove();De.find(".checkitem").prop("checked",false);Ce+=De.prop("outerHTML")}});se.find(".checkAll").prop("checked",false);re.find(".checkAll").prop("checked",false);if(Ce!=""){se.find(".body").prepend(Ce);TransferPlugin.recalculateSourcePart(re);TransferPlugin.recalculateResultPart(se);TransferPlugin.calculateResultData(se,qe);se.find(".body .checkitem").unbind("click");se.find(".body .checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});se.find(".body li").unbind("click");se.find(".body li").click(function(){var Ee=$(this).find(".checkitem");if(Ee.prop("checked"))Ee.prop("checked",false);else Ee.prop("checked",true);TransferPlugin.recalculateResultPart(se)})}});qe.find(".trans-left").click(function(){var Fe=se.find(".checkitem");var Ge="";Fe.each(function(){if($(this).prop("checked")){var He=$(this).parent();He.remove();He.find(".checkitem").prop("checked",false);Ge+=He.prop("outerHTML")}});se.find(".checkAll").prop("checked",false);re.find(".checkAll").prop("checked",false);if(Ge!=""){re.find(".body").prepend(Ge);TransferPlugin.recalculateSourcePart(re);TransferPlugin.recalculateResultPart(se);TransferPlugin.calculateResultData(se,qe);re.find(".body .checkitem").unbind("click");re.find(".body .checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});re.find(".body li").unbind("click");re.find(".body li").click(function(){var Ie=$(this).find(".checkitem");if(Ie.prop("checked"))Ie.prop("checked",false);else Ie.prop("checked",true);TransferPlugin.recalculateSourcePart(se)})}});TransferPlugin.calculateResultData(se,qe);ae=qe.find(".transfer");return ae},updateVal:function(Je,Ke,Le,Me){var Ne=[];var Oe=[];var Pe=Je.getAttrConfig([Le.attr("region-attr")]);if(Pe==null)Pe=Je.regionData[tmpObj.attr("region-attr")+"List"];if(Pe!=null){var Qe=null;if(Me!=null)Qe=Me.split(",");var Re={};if(Qe!=null){for(var Se=0;Se<Qe.length;Se++){Re[Qe[Se]]=true}}for(var Se=0;Se<Pe.length;Se++){var Te=Pe[Se];if(Re[Te["value"]]){Oe.push(Te)}else{Ne.push(Te)}}}var Ue=Ke.find(".source");var Ve=Ke.find(".result");var We=Ne.length;var Xe=Oe.length;var Ye="";if(We>0){var Ze=Ne;for(var Se=0;Se<Ze.length;Se++){Ye+='<li><input class="checkitem" type="checkbox" value="'+Ze[Se].value+'"><span>'+Ze[Se].text+"</span></li>"}}Ue.find(".body").html(Ye);Ye="";Ue.find(".body .checkitem").unbind("click");Ue.find(".body .checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});Ue.find(".body li").unbind("click");Ue.find(".body li").click(function(){var $e=$(this).find(".checkitem");if($e.prop("checked"))$e.prop("checked",false);else $e.prop("checked",true);TransferPlugin.recalculateSourcePart(Ue)});if(Xe>0){var Ze=Oe;for(var Se=0;Se<Ze.length;Se++){Ye+='<li><input class="checkitem" type="checkbox" value="'+Ze[Se].value+'"><span>'+Ze[Se].text+"</span></li>"}}Ve.find(".body").html(Ye);Ve.find(".body .checkitem").click(function(){$(this).prop("checked",!$(this).prop("checked"))});Ve.find(".body li").click(function(){var _e=$(this).find(".checkitem");if(_e.prop("checked"))_e.prop("checked",false);else _e.prop("checked",true);TransferPlugin.recalculateResultPart(Ve)});TransferPlugin.recalculateSourcePart(Ue);TransferPlugin.recalculateResultPart(Ve);TransferPlugin.calculateResultData(Ve,Ke)},recalculateResultPart:function(a4){var b4=a4.find(".checkitem");var c4=0;b4.each(function(){if($(this).prop("checked"))c4++});var d4=b4.length;a4.find(".summary").text(c4+"/"+d4)},calculateResultData:function(e4,f4){var g4=e4.find(".checkitem");var h4="";g4.each(function(){h4+=$(this).attr("value")+","});if(h4.length>1)h4=h4.substring(0,h4.length-1);f4.find(".transfer").val(h4)},recalculateSourcePart:function(i4){var j4=i4.find(".checkitem");var k4=0;j4.each(function(){if($(this).prop("checked"))k4++});var l4=j4.length;i4.find(".summary").text(k4+"/"+l4)}};var RichInputPlugin={render:function(m4,n4,o4){n4.attr("type","hidden");n4.addClass("wrapped");var p4=n4.attr("region-attr");var q4="editor_"+m4.regionId+"_"+p4;var r4=n4.hasClass("disabled");var s4=n4.attr("width");var t4=n4.attr("height");var u4=n4.attr("scrolling");var v4=n4.prop("outerHTML");var w4='<div class="richinput-wrapper region-wrapper">'+v4;w4+='<div class="rich-wrapper">';w4+='<div id="'+q4+'"></div>';w4+="</div>";var x4=$(w4);if(s4!=null)x4.css("width",s4);if(t4!=null)x4.css("height",t4);x4.attr("editor-id",q4);RegionUtil.addRegionUniqueId(x4[0],m4.regionId);n4.replaceWith(x4);if(r4){x4.addClass("disabled")}if(t4.endWith("px")){t4=t4.substring(0,t4.length-2);t4=parseInt(t4)-72+"px"}CKEDITOR.replace(q4,{language:"zh-cn",image_previewText:" ",height:t4});CKEDITOR.instances[q4].setData(o4);CKEDITOR.instances[q4].scrolling=u4;CKEDITOR.instances[q4].on("change",function(y4){var z4=this.getData();x4.find(".richinput").val(z4)});CKEDITOR.instances[q4].on("instanceReady",function(){var A4=this;setTimeout(function(){if(CKEDITOR.instances[q4].scrolling!=null){A4.setAttribute("scrolling",CKEDITOR.instances[q4].scrolling)}A4.document.getBody().setStyle("font-size","16px")})});n4=x4.find(".richinput");n4.val(o4);return n4},updateVal:function(B4,C4,D4,E4){D4.val(E4);var F4=C4.attr("editor-id");setTimeout(function(){CKEDITOR.instances[F4].setData(E4)},100)}};var BarcodePlugin={render:function(G4,H4,I4){H4.attr("type","hidden");H4.addClass("wrapped");H4.addClass("hidden");var J4=H4.attr("format");var K4=H4.attr("region-attr");var L4="barcode_"+G4.regionId+"_"+K4;var M4=H4.attr("height");if(M4==null)M4="100px";if(J4==null)J4="CODE128";var N4=H4.prop("outerHTML");var O4='<div class="barcode-wrapper region-wrapper">'+N4;O4+='<img id="'+L4+'"/>';O4+="</div>";var P4=$(O4);RegionUtil.addRegionUniqueId(P4[0],G4.regionId);H4.replaceWith(P4);P4.attr("barcode-id",L4);if(I4!=null&&I4!=""){var Q4=document.getElementById("barcode");var R4={format:J4,displayValue:true,fontSize:16,height:M4};P4.find("#"+L4+"").JsBarcode(I4,R4)}P4.find(".wrapped").attr("real-val",I4);H4=P4.find(".barcode");H4.val(I4);return H4},updateVal:function(S4,T4,U4,V4){var W4=T4.attr("barcode-id");U4.val(V4);var X4=U4.attr("format");var Y4=U4.attr("height");if(Y4==null)Y4="100px";if(X4==null)X4="CODE128";var Z4={format:X4,displayValue:true,fontSize:16,height:Y4};if(V4!=null&&V4!="")T4.find("#"+W4+"").JsBarcode(V4,Z4);T4.find(".wrapped").attr("real-val",V4)}};var QrcodePlugin={render:function($4,_4,af,bf){_4.attr("type","hidden");_4.addClass("wrapped");_4.addClass("hidden");var cf=_4.attr("format");var df=_4.attr("region-attr");var ef="qrcode_"+$4.regionId+"_"+df;if(bf!=null)ef+=bf;_4.attr("qrcode-id",ef);var ff=_4.prop("outerHTML");var gf=_4.attr("height");var hf=_4.attr("width");if(gf==null)gf="100";else gf=gf.replace("px","");if(hf==null)hf="100";else hf=hf.replace("px","");var jf=_4.attr("color-dark");var kf=_4.attr("color-light");var lf=_4.attr("correct-level");if(jf==null||jf=="")jf="#000000";if(kf==null||kf=="")kf="#ffffff";if(lf==null||lf=="")lf="H";var mf='<div class="qrcode-wrapper region-wrapper">'+ff;mf+='<div id="'+ef+'"></div>';mf+="</div>";var nf=$(mf);RegionUtil.addRegionUniqueId(nf[0],$4.regionId);_4.replaceWith(nf);new QRCode(ef,{text:af,width:hf,height:gf,colorDark:jf,colorLight:kf,correctLevel:QRCode.CorrectLevel[lf]});_4=nf.find(".wrapped");_4.attr("real-val",af);return _4},updateVal:function(of,pf,qf,rf){var sf=qf.attr("format");var tf=qf.attr("height");var uf=qf.attr("width");if(tf==null)tf="100";else tf=tf.replace("px","");if(uf==null)uf="100";else uf=uf.replace("px","");var vf=qf.attr("color-dark");var wf=qf.attr("color-light");var xf=qf.attr("correct-level");if(vf==null||vf=="")vf="#000000";if(wf==null||wf=="")wf="#ffffff";if(xf==null||xf=="")xf="H";var yf=qf.attr("qrcode-id");var zf=qf.prop("outerHTML");zf+='<div id="'+yf+'"></div>';pf.html(zf);new QRCode(yf,{text:rf,width:uf,height:tf,colorDark:vf,colorLight:wf,correctLevel:QRCode.CorrectLevel[xf]});pf.find(".wrapped").attr("real-val",rf)}};var RadioPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var isDisabled=tmpObj.hasClass("disabled");tmpObj.attr("type","hidden");tmpObj.addClass("wrapped");var width=tmpObj.attr("width");var layout=tmpObj.attr("layout");if(layout==null)layout="h";var regionDsName=tmpObj.attr("region-ds");var options=RegionUtil.getRegionDsList(region,regionDsName);var hiddenInputHtml=tmpObj.prop("outerHTML");var replaceHtml='<div class="radio-wrapper region-wrapper">'+hiddenInputHtml;replaceHtml+='<div class="options">';if(options!=null){for(var i=0;i<options.length;i++){if(layout=="h"){replaceHtml+='<div class="radio-item">'}else{replaceHtml+='<div class="radio-item vertical">'}if(paraData==options[i].value)replaceHtml+='\t<div class="radio-input checked"></div>';else replaceHtml+='\t<div class="radio-input"></div>';replaceHtml+='\t<div class="text" val='+options[i].value+">"+options[i].text+"</div>";replaceHtml+="</div>"}}replaceHtml+="\t</div>";replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);if(isDisabled){replaced.addClass("disabled")}replaced.find(".radio-item").click(function(){var radioItem=$(this);var inputItem=radioItem.find(".radio-input");var checked=inputItem.hasClass("checked");var newVal=null;if(!checked){radioItem.parent().find(".radio-input").removeClass("checked");inputItem.addClass("checked");newVal=radioItem.find(".text").attr("val");replaced.find(".wrapped").val(newVal);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newVal)")}}});tmpObj=replaced.find(".wrapped");if(width!=null){replaced.css("width",width)}tmpObj.val(paraData);return tmpObj},refreshDataSource:function(region,wrapperElemObj,regionElemObj,options){var paraData=regionElemObj.val();var onchange=regionElemObj.attr("onchange");var layout=regionElemObj.attr("layout");if(layout==null)layout="h";var optionsHtml="";if(options!=null){for(var i=0;i<options.length;i++){if(layout=="h"){optionsHtml+='<div class="radio-item">'}else{optionsHtml+='<div class="radio-item vertical">'}if(paraData==options[i].value)optionsHtml+='\t<div class="radio-input checked"></div>';else optionsHtml+='\t<div class="radio-input"></div>';optionsHtml+='\t<div class="text" val='+options[i].value+">"+options[i].text+"</div>";optionsHtml+="</div>"}}wrapperElemObj.find(".options").html(optionsHtml);RegionUtil.addRegionUniqueId(wrapperElemObj[0],region.regionId);wrapperElemObj.find(".radio-item").click(function(){var radioItem=$(this);var inputItem=radioItem.find(".radio-input");var checked=inputItem.hasClass("checked");var newVal=null;if(!checked){radioItem.parent().find(".radio-input").removeClass("checked");inputItem.addClass("checked");newVal=radioItem.find(".text").attr("val");wrapperElemObj.find(".wrapped").val(newVal)}if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newVal)")}})},updateVal:function(Af,Bf,Cf,Df){Cf.val(Df);Bf.find(".radio-input").removeClass("checked");Bf.find(".radio-item").each(function(){var Ef=$(this);var Ff=Ef.find(".radio-input");if(Df==Ef.find(".text").attr("val")){Ff.addClass("checked");return false}})}};var CheckboxPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var isDisabled=tmpObj.hasClass("disabled");tmpObj.attr("type","hidden");tmpObj.addClass("wrapped");var width=tmpObj.attr("width");var layout=tmpObj.attr("layout");if(layout==null)layout="h";var regionDsName=tmpObj.attr("region-ds");var options=RegionUtil.getRegionDsList(region,regionDsName);var hiddenInputHtml=tmpObj.prop("outerHTML");if(paraData==null)paraData="";else paraData+="";if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=paraData.split(",");var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}var replaceHtml='<div class="checkbox-wrapper region-wrapper">'+hiddenInputHtml;replaceHtml+='<div class="options">';if(options!=null){for(var i=0;i<options.length;i++){if(layout=="h"){replaceHtml+='<div class="checkbox-item">'}else{replaceHtml+='<div class="checkbox-item vertical">'}if(valueCache[options[i].value])replaceHtml+='\t<div class="checkbox-input checked"></div>';else replaceHtml+='\t<div class="checkbox-input"></div>';replaceHtml+='\t<div class="text" val='+options[i].value+">"+options[i].text+"</div>";replaceHtml+="</div>"}}replaceHtml+="\t</div>";replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);if(isDisabled){replaced.addClass("disabled")}replaced.find(".checkbox-item").click(function(){var radioItem=$(this);var inputItem=radioItem.find(".checkbox-input");var checked=inputItem.hasClass("checked");var newVal=null;if(!checked){inputItem.addClass("checked")}else{inputItem.removeClass("checked")}replaced.find(".checked").each(function(){if(newVal==null||newVal=="")newVal=$(this).parent().find(".text").attr("val");else newVal+=","+$(this).parent().find(".text").attr("val")});replaced.find(".wrapped").val(newVal);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newVal)")}});tmpObj=replaced.find(".wrapped");if(width!=null){replaced.css("width",width)}tmpObj.val(paraData);return tmpObj},refreshDataSource:function(region,wrapperElemObj,regionElemObj,options){var paraData=regionElemObj.val();var onchange=regionElemObj.attr("onchange");var optionsHtml="";if(options!=null){for(var i=0;i<options.length;i++){optionsHtml+='<div class="checkbox-item">';if(paraData==options[i].value)optionsHtml+='\t<div class="checkbox-input checked"></div>';else optionsHtml+='\t<div class="checkbox-input"></div>';optionsHtml+='\t<div class="text" val='+options[i].value+">"+options[i].text+"</div>";optionsHtml+="</div>"}}wrapperElemObj.find(".options").html(optionsHtml);RegionUtil.addRegionUniqueId(wrapperElemObj[0],region.regionId);wrapperElemObj.find(".checkbox-item").click(function(){var radioItem=$(this);var inputItem=radioItem.find(".checkbox-input");var checked=inputItem.hasClass("checked");var newVal=null;if(!checked){inputItem.addClass("checked")}else{inputItem.removeClass("checked")}wrapperElemObj.find(".checked").each(function(){if(newVal==null||newVal=="")newVal=$(this).parent().find(".text").attr("val");else newVal+=","+$(this).parent().find(".text").attr("val")});wrapperElemObj.find(".wrapped").val(newVal);if(onchange!=null&&onchange!=""){eval(onchange+".call(this,newVal)")}});if(paraData.endWith(",")){paraData=paraData.substring(0,paraData.length-1)}var currentValueArray=paraData.split(",");var valueCache={};for(var i=0;i<currentValueArray.length;i++){valueCache[currentValueArray[i]]=true}var newVal="";var initCheckItems=wrapperElemObj.find(".checkbox-input");initCheckItems.each(function(){var Gf=$(this).parent().children(".text");var Hf=Gf.attr("val");if(valueCache[Hf]){$(this).addClass("checked");if(newVal==null)newVal=Gf.attr("val");else newVal+=","+Gf.attr("val")}else{$(this).removeClass("checked")}});wrapperElemObj.find(".wrapped").val(newVal)},updateVal:function(If,Jf,Kf,Lf){Kf.val(Lf);if(Lf==null)Lf="";else Lf=""+Lf;if(Lf.endWith(",")){Lf=Lf.substring(0,Lf.length-1)}var Mf=Lf.split(",");var Nf={};for(var Of=0;Of<Mf.length;Of++){Nf[Mf[Of]]=true}Jf.find(".checkbox-item").each(function(){var Pf=$(this);var Qf=Pf.find(".checkbox-input");if(Nf[Pf.find(".text").attr("val")])Qf.addClass("checked");else Qf.removeClass("checked")})}};var InputPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var isDisabled=tmpObj.hasClass("disabled");if(isDisabled){tmpObj.attr("readonly","readonly")}var readonly=tmpObj.attr("readonly");if(readonly!=undefined){isDisabled=true}var hide=tmpObj.attr("hide");if("true"==hide){tmpObj.closest(".data-block-wrapper").addClass("hidden")}var tail=tmpObj.attr("tail");tmpObj.addClass("wrapped");var width=tmpObj.attr("width");if(width!=null){tmpObj.css("width",width)}var maxlength=tmpObj.attr("maxlength");var wrappedLabel=tmpObj.attr("label");if(maxlength==null)maxlength=30;var replaceHtml=null;if(wrappedLabel==null){replaceHtml='<div class="input-wrapper region-wrapper">'+tmpObj.prop("outerHTML")}else{replaceHtml='<div class="input-wrapper region-wrapper"><span class="wrapped-label">'+wrappedLabel+"</span>"+tmpObj.prop("outerHTML")}var showCount=tmpObj.attr("show-count");var quickClear="";if(!isDisabled){quickClear='<div class="quick-clear hidden"><i class="fa-light fa-close"></i></div>'}if(showCount=="true"){if(tail!=null)replaceHtml+='\t<div class="text-count-wrap"><div class="text-count hidden text-count-ref"></div> '+quickClear+'  <div class="text-tail"></div></div>';else replaceHtml+='\t<div class="text-count-wrap"><div class="text-count hidden text-count-ref"></div> '+quickClear+"  </div>"}else{if(tail!=null)replaceHtml+='\t<div class="text-count-wrap">'+quickClear+'<div class="text-tail"></div></div>';else replaceHtml+='\t<div class="text-count-wrap">'+quickClear+"</div>"}replaceHtml+="</div>";var replaced=$(replaceHtml);if(width!=null){replaced.css("width",width)}if(tail!=null)replaced.find(".text-tail").html(tail);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);tmpObj=replaced.find(".wrapped");var count=maxlength;if(paraData==null||paraData==""){paraData=tmpObj.attr("default")}if(paraData!=null){paraData=paraData+"";count-=paraData.length}else{paraData=""}replaced.find(".text-count").text(count);tmpObj.val(paraData);tmpObj.focus(function(){replaced.find(".text-count").removeClass("hidden");replaced.find(".quick-clear").removeClass("hidden")});tmpObj.blur(function(){replaced.find(".text-count").addClass("hidden");setTimeout(function(){replaced.find(".quick-clear").addClass("hidden")},200)});tmpObj.on("input",function(){var available=maxlength-($(this).val()+"").length;var wrapped=replaced.find(".wrapped");var curText=wrapped.val();if(available<0){wrapped.val((curText+"").substring(0,maxlength))}else replaced.find(".text-count").text(available);if(onchange!=null&&onchange!=""){var indexTag=onchange.indexOf("(");if(indexTag==-1){eval(onchange+".call(wrapped,curText)")}else{var script=onchange.substring(0,indexTag)+".call(wrapped,curText,"+onchange.substring(indexTag+1,onchange.length);eval(script)}}});replaced.find(".quick-clear>.fa-close").click(function(){$(this).closest(".region-wrapper").find(".wrapped").val("")});var onsearch=tmpObj.attr("onsearch");if(onsearch!=null&&onsearch.trim()!=""){tmpObj.on("focus",function(){var wrapped=replaced.find(".wrapped");var curText=wrapped.val();var indexTag=onsearch.indexOf("(");if(indexTag==-1){eval(onsearch+".call(wrapped,curText)")}else{var script=onsearch.substring(0,indexTag)+".call(wrapped,curText,"+onsearch.substring(indexTag+1,onsearch.length);eval(script)}});tmpObj.on("input",function(){var wrapped=replaced.find(".wrapped");var curText=wrapped.val();var indexTag=onsearch.indexOf("(");if(indexTag==-1){eval(onsearch+".call(wrapped,curText)")}else{var script=onsearch.substring(0,indexTag)+".call(wrapped,curText,"+onsearch.substring(indexTag+1,onsearch.length);eval(script)}})}return tmpObj},updateVal:function(Rf,Sf,Tf,Uf){if(Uf==null||Uf==""){Uf=Tf.attr("default")}if(Uf==null)Uf="";Tf.val(Uf);var Vf=Tf.attr("maxlength");if(Vf==null)Vf=30;var Wf=Vf-Uf.length;Sf.find(".text-count").text(Wf)}};var PasswordPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var hide=tmpObj.attr("hide");if("true"==hide){tmpObj.closest(".data-block-wrapper").addClass("hidden")}var tail=tmpObj.attr("tail");tmpObj.addClass("wrapped");var width=tmpObj.attr("width");if(width!=null){tmpObj.css("width",width)}var maxlength=tmpObj.attr("maxlength");var wrappedLabel=tmpObj.attr("label");if(maxlength==null)maxlength=30;var replaceHtml=null;if(wrappedLabel==null){replaceHtml='<div class="password-wrapper region-wrapper">'+tmpObj.prop("outerHTML")}else{replaceHtml='<div class="password-wrapper region-wrapper"><span class="wrapped-label">'+wrappedLabel+"</span>"+tmpObj.prop("outerHTML")}if(tail!=null)replaceHtml+='\t<div class="text-count-wrap"><div class="text-tail"></div><div class="text-count text-count-ref hidden"></div></div>';else replaceHtml+='\t<div class="text-count-wrap"><div class="text-count text-count-ref hidden"></div></div>';replaceHtml+="</div>";var replaced=$(replaceHtml);if(width!=null){replaced.css("width",width)}if(tail!=null)replaced.find(".text-tail").html(tail);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);var count=maxlength;if(paraData!=null){paraData=paraData+"";count-=paraData.length}else{paraData=""}replaced.find(".text-count").text(count);tmpObj=replaced.find(".wrapped");tmpObj.val(paraData);tmpObj.focus(function(){replaced.find(".text-count").removeClass("hidden")});tmpObj.blur(function(){replaced.find(".text-count").addClass("hidden")});tmpObj.on("input",function(){var available=maxlength-($(this).val()+"").length;var wrapped=replaced.find(".wrapped");var curText=wrapped.val();if(available<0){wrapped.val((curText+"").substring(0,maxlength))}else replaced.find(".text-count").text(available);if(onchange!=null&&onchange!=""){var indexTag=onchange.indexOf("(");if(indexTag==-1){eval(onchange+".call(wrapped,curText)")}else{var script=onchange.substring(0,indexTag)+".call(wrapped,curText,"+onchange.substring(indexTag+1,onchange.length);eval(script)}}});var onsearch=tmpObj.attr("onsearch");if(onsearch!=null&&onsearch.trim()!=""){tmpObj.on("focus",function(){var wrapped=replaced.find(".wrapped");var curText=wrapped.val();var indexTag=onsearch.indexOf("(");if(indexTag==-1){eval(onsearch+".call(wrapped,curText)")}else{var script=onsearch.substring(0,indexTag)+".call(wrapped,curText,"+onsearch.substring(indexTag+1,onsearch.length);eval(script)}});tmpObj.on("input",function(){var wrapped=replaced.find(".wrapped");var curText=wrapped.val();var indexTag=onsearch.indexOf("(");if(indexTag==-1){eval(onsearch+".call(wrapped,curText)")}else{var script=onsearch.substring(0,indexTag)+".call(wrapped,curText,"+onsearch.substring(indexTag+1,onsearch.length);eval(script)}})}return tmpObj},updateVal:function(Xf,Yf,Zf,$f){if($f==null)$f="";Zf.val($f);var _f=Zf.attr("maxlength");if(_f==null)_f=30;var a5=_f-$f.length;Yf.find(".text-count").text(a5)}};var InputMutiPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";var isDisabled=tmpObj.hasClass("disabled");tmpObj.addClass("wrapped");tmpObj.addClass("hidden");var width=tmpObj.attr("width");tmpObj.css("width",width);var placeholder=tmpObj.attr("placeholder");var height=tmpObj.attr("height");if(height==null)height="102px";var maxlength=tmpObj.attr("maxlength");var wrappedLabel=tmpObj.attr("label");if(maxlength==null)maxlength=30;var replaceHtml=null;if(wrappedLabel==null){replaceHtml='<div class="input-muti-wrapper region-wrapper">'}else{replaceHtml='<div class="input-muti-wrapper region-wrapper"><span class="wrapped-label">'+wrappedLabel+"</span>"}if(isDisabled)replaceHtml+='<textarea region-attr="'+tmpObj.attr("region-attr")+'" class="wrapped input-area form-control disabled" style="height:'+height+'" ></textarea>';else replaceHtml+='<textarea region-attr="'+tmpObj.attr("region-attr")+'" class="region-editable wrapped input-area form-control" style="height:'+height+'" ></textarea>';replaceHtml+='\t<div class="text-count-wrap"><div class="text-count hidden"></div></div>';if(placeholder!=null)replaceHtml+='\t<div class="place-holder hidden">'+placeholder+"</div>";else replaceHtml+='\t<div class="place-holder hidden"></div>';replaceHtml+="</div>";var replaced=$(replaceHtml);if(width!=null){replaced.css("width",width)}RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);var count=maxlength;if(paraData!=null){paraData=paraData+"";count-=paraData.length}else{paraData=""}replaced.find(".text-count").text(count);tmpObj=replaced.find(".wrapped");tmpObj.val(paraData);replaced.find(".input-area").focus(function(){replaced.find(".text-count").removeClass("hidden")});replaced.find(".input-area").blur(function(){replaced.find(".text-count").addClass("hidden")});replaced.find(".input-area").val(paraData);try{paraData=JSON.stringify(JSON.parse(paraData),null,2)}catch(e){}replaced.find(".input-area").val(paraData);setTimeout(function(){replaced.find(".place-holder").css("top","8px")});if(paraData.length==0){replaced.find(".place-holder").removeClass("hidden")}replaced.find(".input-area").on("input",function(){var curText=$(this).val();var available=maxlength-(curText+"").length;var wrapped=replaced.find(".wrapped");if(available<0){$(this).val((curText+"").substring(0,maxlength));replaced.find(".text-count").text(0)}else{replaced.find(".text-count").text(available)}if(curText.length>0)replaced.find(".place-holder").addClass("hidden");else replaced.find(".place-holder").removeClass("hidden");if(onchange!=null&&onchange!=""){eval(onchange+".call(wrapped,curText)")}});return tmpObj},updateVal:function(b5,c5,d5,e5){if(e5==null)e5="";try{e5=JSON.stringify(JSON.parse(e5),null,2)}catch(h5){}d5.val(e5);var f5=d5.attr("maxlength");if(f5==null)f5=30;var g5=f5-e5.length;c5.find(".text-count").text(g5);c5.find(".input-area").val(e5);if(e5.length>0)c5.find(".place-holder").addClass("hidden");else c5.find(".place-holder").removeClass("hidden")}};var EditableTablePlugin={textHtml:'<input type="text" region-attr="field" class="inner text form-control" maxlength="MAXLEN" width="100%">',sSelectHtml:'<select region-attr="field" class="inner s-select form-control" width="100%" region-ds="DSName"></select>',mSelectHtml:'<select type="multiple" region-attr="field" class="inner form-control m-select" width="100%" region-ds="DSName"></select>',render:function(i5,j5,k5){j5.addClass("wrapped");j5.addClass("hidden");var l5=j5.attr("region-attr");var m5=j5.attr("show-header");if(m5==null||m5=="true"){m5=true}else{m5=false}var n5=j5.attr("allow-create");var o5=j5.attr("width");if(o5!=null)j5.css("width",o5);var p5=j5.attr("height");if(p5==null)p5="auto";var q5=j5.attr("maxlength");var r5=j5.attr("label");if(q5==null)q5=30;var s5=null;if(r5==null){s5='<div class="editable-table-wrapper region-wrapper">'+j5.prop("outerHTML")}else{s5='<div class="editable-table-wrapper region-wrapper"><span class="wrapped-label">'+r5+"</span>"+j5.prop("outerHTML")}var t5=null;if(k5!=null&&k5!=""){if(typeof k5==="string")t5=JSON.parse(k5);else t5=k5}var u5,v5=null;if(i5.configs==null){i5.configs={}}u5=i5.configs[l5];if(u5==null){i5.configs[l5]={}}if(u5!=null)v5=u5["columns"];if(v5==null){if(t5==null){t5=[{col1:"val1",col2:"val2",col3:"val3"},{col1:"val3",col2:"val4",col3:"val5"}]}for(var w5=0;w5<t5.length;w5++){var x5=t5[w5];var y5=[];var z5=null;for(x in x5){z5={};z5["field"]=x;z5["label"]=x;z5["type"]="text";z5["width"]="100px";y5.push(z5)}if(v5==null||v5.length<y5)v5=y5}i5.configs[l5]["columns"]=v5}if(v5==null)return;if(m5)s5+='<div class="header-row">';else s5+='<div class="header-row hidden">';for(var A5=0;A5<v5.length;A5++){var B5=v5[A5];if(B5["width"]==null){B5["width"]="100px"}s5+='<div class="cell" style="width:'+B5["width"]+'">'+B5["label"]+"</div>"}s5+='<div class="cell" style="display: flex;justify-content: center;align-items: center;"><input class="promptCheck" type="checkbox"><span class="prompt">删除提示</span></div>';s5+="</div>";s5+=EditableTablePlugin.resolveDataHtml(t5,v5,0);if(n5==null||n5=="true")s5+='<div class="footer-row"><i class="newRowBtn fa-solid fa-plus"></i></div>';s5+="</div>";var C5=$(s5);if(o5!=null){C5.css("width",o5)}RegionUtil.addRegionUniqueId(C5[0],i5.regionId);j5.replaceWith(C5);var D5=j5.attr("delete-propmt");if(D5==null||D5=="true")C5.find(".promptCheck").prop("checked",true);C5.find(".text").each(function(){var I5=$(this).closest(".editable-row").attr("row-data-index");var J5=t5[I5];InputPlugin.render(i5,$(this),J5[$(this).attr("region-attr")])});C5.find(".s-select").each(function(){var K5=$(this).closest(".editable-row").attr("row-data-index");var L5=t5[K5];DropdownPlugin.render(i5,$(this),L5[$(this).attr("region-attr")])});C5.find(".m-select").each(function(){var M5=$(this).closest(".editable-row").attr("row-data-index");var N5=t5[M5];MultiDropdownPlugin.render(i5,$(this),N5[$(this).attr("region-attr")])});j5=C5.children(".wrapped");j5.val(k5);var E5=j5.attr("allow-drag");if(E5==null||E5=="true"){RegionUtil.enableChildDrag(C5,".drag");C5.find(".drag").removeClass("hidden")}var F5=j5.attr("allow-delete");if(F5==null||F5=="true"){var G5=C5.find(".remove");G5.removeClass("hidden");G5.unbind("click");G5.click(function(O5){EditableTablePlugin.deleteRowData(O5)})}if(n5==null||n5=="true"){var H5=C5.find(".newRowBtn");H5.click(function(P5){EditableTablePlugin.newRowData(P5)})}return j5},updateVal:function(Q5,R5,S5,T5){R5.find(".editable-row").remove();var U5=null;console.log(T5);if(T5!=null&&T5!=""){if(typeof T5=="string")U5=JSON.parse(T5);else U5=T5}console.log("updateVal");console.log(U5);EditableTablePlugin.subUpdate(Q5,R5,S5,U5,0)},newRowData:function(V5){var W5=RegionUtil.getEventTarget(V5);var X5=RegionUtil.getRegionByElem(W5);var Y5=$(W5).closest(".editable-table-wrapper");var Z5=Y5.find(".wrapped");var $5=Y5.find(".editable-row").length;EditableTablePlugin.subUpdate(X5,Y5,Z5,[{}],$5);var _5=Z5.attr("max-rows");if(_5!=null){try{_5=parseInt(_5)}catch(ag){}if(_5!=null){if(_5==$5+1){Y5.find(".newRowBtn").addClass("hidden")}}}},deleteRowData:function(bg){var cg=RegionUtil.getEventTarget(bg);var dg=$(cg).closest(".editable-table-wrapper");var eg=dg.find(".promptCheck").prop("checked");var fg=dg.find(".editable-row").length;var gg=dg.find(".wrapped");var hg=gg.attr("max-rows");if(eg){RegionUtil.confirm("确认删除此行记录?","提示",function(){if(hg!=null){try{hg=parseInt(hg)}catch(ig){}if(hg!=null){if(hg==fg){dg.find(".newRowBtn").removeClass("hidden")}}}$(cg).closest(".editable-row").remove()})}else{if(hg!=null){try{hg=parseInt(hg)}catch(jg){}if(hg!=null){if(hg==fg){dg.find(".newRowBtn").removeClass("hidden")}}}$(cg).closest(".editable-row").remove()}},subUpdate:function(kg,lg,mg,ng,og){if(ng==null||ng.length==0)return;var pg=mg.attr("region-attr");var qg=kg.configs[pg]["columns"];var rg=EditableTablePlugin.resolveDataHtml(ng,qg,og);var sg=lg.find(".footer-row");var tg=$(rg);if(sg.length==0){lg.append(tg)}else{tg.insertBefore(sg)}RegionUtil.addRegionUniqueId(tg[0],kg.regionId);tg.find(".text").each(function(){var xg=$(this).closest(".editable-row").attr("row-data-index");var yg=ng[xg-og];InputPlugin.render(kg,$(this),yg[$(this).attr("region-attr")])});tg.find(".s-select").each(function(){var zg=$(this).closest(".editable-row").attr("row-data-index");var Ag=ng[zg-og];DropdownPlugin.render(kg,$(this),Ag[$(this).attr("region-attr")])});tg.find(".m-select").each(function(){var Bg=$(this).closest(".editable-row").attr("row-data-index");var Cg=ng[Bg-og];MultiDropdownPlugin.render(kg,$(this),Cg[$(this).attr("region-attr")])});var ug=mg.attr("allow-drag");if(ug==null||ug=="true"){RegionUtil.enableChildDrag(lg,".drag");tg.find(".drag").removeClass("hidden")}var vg=mg.attr("allow-delete");if(vg==null||vg=="true"){var wg=tg.find(".remove");wg.removeClass("hidden");wg.unbind("click");wg.click(function(Dg){EditableTablePlugin.deleteRowData(Dg)})}},resolveDataHtml:function(Eg,Fg,Gg){var Hg="";if(Eg!=null){for(var Ig=0;Ig<Eg.length;Ig++){var Jg=Eg[Ig];Hg+='<div class="editable-row" row-data-index="'+(Gg+Ig)+'">';for(var Kg=0;Kg<Fg.length;Kg++){var Lg=Fg[Kg];var Mg="";if(Lg["type"]=="text"){Mg="text-overflow"}Hg+='<div field="'+Lg["field"]+'"class="cell '+Mg+'" style="width:'+Lg["width"]+'">';if(Lg["type"]=="text"){var Ng=EditableTablePlugin.textHtml.replace("field",Lg["field"]);var Og=Lg["maxlength"];if(Og==null)Og=30;Ng=Ng.replace("MAXLEN",Og);Hg+=Ng}else if(Lg["type"]=="s-select"){var Ng=EditableTablePlugin.sSelectHtml.replace("field",Lg["field"]);if(Lg["dataSourceType"]=="static"){var Pg=RegionUtil.getUUID()+"_DS";while(window.DataList.get(Pg)!=null){Pg=RegionUtil.getUUID()+"_DS"}window.DataList.put(Pg,Lg["dataSource"]);Ng=Ng.replace("DSName",Pg)}else if(Lg["dataSourceType"]=="global"){Ng=Ng.replace("DSName",Lg["dataSource"])}Hg+=Ng}else if(Lg["type"]=="m-select"){var Ng=EditableTablePlugin.mSelectHtml.replace("field",Lg["field"]);if(Lg["dataSourceType"]=="static"){var Pg=RegionUtil.getUUID()+"_DS";while(window.DataList.get(Pg)!=null){Pg=RegionUtil.getUUID()+"_DS"}window.DataList.put(Pg,Lg["dataSource"]);Ng=Ng.replace("DSName",Pg)}else if(Lg["dataSourceType"]=="global"){Ng=Ng.replace("DSName",Lg["dataSource"])}Hg+=Ng}Hg+="</div>"}Hg+='<div class="cell" style="width:80px"><i class="drag fa-solid fa-hand-rock hidden"></i><i class="remove fa-solid fa-trash hidden"></i></div>';Hg+="</div>"}}return Hg},packData:function(Qg){var Rg=Qg.parent().find(".editable-row");var Sg=null;var Tg=[];for(var Ug=0;Ug<Rg.length;Ug++){Sg=Rg[Ug];var Vg={};$(Sg).children(".cell").each(function(Wg){var Xg=this.getAttribute("field");if(Xg==null)return true;Vg[Xg]=$(this).find(".inner").val()});Tg.push(Vg)}if(Tg.length>0){return JSON.stringify(Tg)}return null}};var CodePlugin={render:function(Yg,Zg,$g){Zg.attr("type","hidden");Zg.addClass("wrapped");Zg.addClass("hidden");var _g=Zg.attr("region-attr");var a6='<div class="code-wrapper region-wrapper">';a6+=Zg.prop("outerHTML");a6+="<code></code>";a6+="</div>";var b6=$(a6);var c6=b6.find("code");c6.attr("width",Zg.attr("width"));c6.attr("height",Zg.attr("height"));c6.attr("name",Zg.attr("name"));c6.attr("showheader",Zg.attr("showheader"));c6.attr("escapeHtml",Zg.attr("escapeHtml"));b6.css("min-width",Zg.attr("width"));RegionUtil.addRegionUniqueId(b6[0],Yg.regionId);Zg.replaceWith(b6);c6.text($g);b6.find(".wrapped").attr("real-val",$g);RegionUtil.resolveSingleCode(Yg,c6);return b6},updateVal:function(d6,e6,f6,g6){var h6="<code></code>";var i6=$(h6);i6.attr("width",f6.attr("width"));i6.attr("height",f6.attr("height"));i6.attr("name",f6.attr("name"));i6.attr("showheader",f6.attr("showheader"));i6.attr("escapeHtml",f6.attr("escapeHtml"));e6.css("min-width",f6.attr("width"));RegionUtil.addRegionUniqueId(i6[0],d6.regionId);e6.find(".codepre").replaceWith(i6);var j6=e6.find("code");j6.text(g6);RegionUtil.resolveSingleCode(d6,j6);e6.find(".wrapped").attr("real-val",g6)}};var ColorPickerPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");if(onchange==null)onchange="";tmpObj.addClass("wrapped");tmpObj.attr("type","hidden");var hiddenInputHtml=tmpObj.prop("outerHTML");var replaceHtml='<div class="colorpicker-wrapper region-wrapper">'+hiddenInputHtml;replaceHtml+='<div class="color-preview"></div>';replaceHtml+='<div class="color-num"></div>';replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);var colorPreview=replaced.find(".color-preview");if(paraData==null||paraData==""){paraData="#FFFFFF"}if(paraData!="#FFFFFF"&&paraData.toUpperCase()!="#FFFFFF")colorPreview.css("border-color",paraData);colorPreview.css("background-color",paraData);replaced.find(".color-num").text(paraData);colorPreview.colorPicker({animationSpeed:150,GPU:true,doRender:true|"selector",opacity:true,scrollResize:true,renderCallback:function(elm,toggled){var backGroundColor=elm.css("background-color");if(backGroundColor.startWith("rgba")){}else{var colorArray=backGroundColor.substring(4,backGroundColor.length-1).split(",");backGroundColor="#";for(var i=0;i<colorArray.length;i++){var tmpStr=parseInt(colorArray[i]).toString(16);if(tmpStr.length==1)tmpStr="0"+tmpStr;backGroundColor+=tmpStr.toUpperCase()}}var wrapped=replaced.find(".wrapped");replaced.find(".color-num").text(backGroundColor);wrapped.val(backGroundColor);if(backGroundColor=="#FFFFFF"){elm.css("border-color","lime")}else elm.css("border-color",backGroundColor);if(onchange!=null&&onchange!=""){eval(onchange+".call(wrapped,backGroundColor)")}return null}});tmpObj=replaced.find(".wrapped");tmpObj.val(paraData);return tmpObj},updateVal:function(k6,l6,m6,n6){m6.val(n6);var o6=l6.find(".color-preview");if(n6==null||n6==""){n6="#FFFFFF"}if(n6!="#FFFFFF"&&n6.toUpperCase()!="#FFFFFF")o6.css("border-color",n6);o6.css("background-color",n6);l6.find(".color-num").text(n6)}};!function(p6,q6){"object"==typeof exports?module.exports=q6(p6):"function"==typeof define&&define.amd?define("colors",[],function(){return q6(p6)}):p6.Colors=q6(p6)}(this,function(r6,s6){"use strict";function t6(N6,O6,P6,Q6,R6){if("string"==typeof O6){var O6=M6.txt2color(O6);P6=O6.type,G6[P6]=O6[P6],R6=R6!==s6?R6:O6.alpha}else if(O6)for(var S6 in O6)N6[P6][S6]=B6(O6[S6]/C6[P6][S6][1],0,1);return R6!==s6&&(N6.alpha=B6(+R6,0,1)),v6(P6,Q6?N6:s6)}function u6(T6,U6,V6){var W6=F6.options.grey,X6={};return X6.RGB={r:T6.r,g:T6.g,b:T6.b},X6.rgb={r:U6.r,g:U6.g,b:U6.b},X6.alpha=V6,X6.equivalentGrey=E6(W6.r*T6.r+W6.g*T6.g+W6.b*T6.b),X6.rgbaMixBlack=z6(U6,{r:0,g:0,b:0},V6,1),X6.rgbaMixWhite=z6(U6,{r:1,g:1,b:1},V6,1),X6.rgbaMixBlack.luminance=y6(X6.rgbaMixBlack,!0),X6.rgbaMixWhite.luminance=y6(X6.rgbaMixWhite,!0),F6.options.customBG&&(X6.rgbaMixCustom=z6(U6,F6.options.customBG,V6,1),X6.rgbaMixCustom.luminance=y6(X6.rgbaMixCustom,!0),F6.options.customBG.luminance=y6(F6.options.customBG,!0)),X6}function v6(Y6,Z6){var $6,_6,ah,bh=Z6||G6,ch=M6,dh=F6.options,eh=C6,fh=bh.RND,gh="",hh="",ih={hsl:"hsv",rgb:Y6},jh=fh.rgb;if("alpha"!==Y6){for(var kh in eh)if(!eh[kh][kh]){Y6!==kh&&(hh=ih[kh]||"rgb",bh[kh]=ch[hh+"2"+kh](bh[hh])),fh[kh]||(fh[kh]={}),$6=bh[kh];for(gh in $6)fh[kh][gh]=E6($6[gh]*eh[kh][gh][1])}jh=fh.rgb,bh.HEX=ch.RGB2HEX(jh),bh.equivalentGrey=dh.grey.r*bh.rgb.r+dh.grey.g*bh.rgb.g+dh.grey.b*bh.rgb.b,bh.webSave=_6=w6(jh,51),bh.webSmart=ah=w6(jh,17),bh.saveColor=jh.r===_6.r&&jh.g===_6.g&&jh.b===_6.b?"web save":jh.r===ah.r&&jh.g===ah.g&&jh.b===ah.b?"web smart":"",bh.hueRGB=M6.hue2RGB(bh.hsv.h),Z6&&(bh.background=u6(jh,bh.rgb,bh.alpha))}var lh,mh,nh,oh=bh.rgb,ph=bh.alpha,qh="luminance",rh=bh.background;return lh=z6(oh,{r:0,g:0,b:0},ph,1),lh[qh]=y6(lh,!0),bh.rgbaMixBlack=lh,mh=z6(oh,{r:1,g:1,b:1},ph,1),mh[qh]=y6(mh,!0),bh.rgbaMixWhite=mh,dh.customBG&&(nh=z6(oh,rh.rgbaMixCustom,ph,1),nh[qh]=y6(nh,!0),nh.WCAG2Ratio=A6(nh[qh],rh.rgbaMixCustom[qh]),bh.rgbaMixBGMixCustom=nh,nh.luminanceDelta=D6.abs(nh[qh]-rh.rgbaMixCustom[qh]),nh.hueDelta=x6(rh.rgbaMixCustom,nh,!0)),bh.RGBLuminance=y6(jh),bh.HUELuminance=y6(bh.hueRGB),dh.convertCallback&&dh.convertCallback(bh,Y6),bh}function w6(sh,th){var uh={},vh=0,wh=th/2;for(var xh in sh)vh=sh[xh]%th,uh[xh]=sh[xh]+(vh>wh?th-vh:-vh);return uh}function x6(yh,zh,Ah){return(D6.max(yh.r-zh.r,zh.r-yh.r)+D6.max(yh.g-zh.g,zh.g-yh.g)+D6.max(yh.b-zh.b,zh.b-yh.b))*(Ah?255:1)/765}function y6(Bh,Ch){for(var Dh=Ch?1:255,Eh=[Bh.r/Dh,Bh.g/Dh,Bh.b/Dh],Fh=F6.options.luminance,Gh=Eh.length;Gh--;)Eh[Gh]=Eh[Gh]<=.03928?Eh[Gh]/12.92:D6.pow((Eh[Gh]+.055)/1.055,2.4);return Fh.r*Eh[0]+Fh.g*Eh[1]+Fh.b*Eh[2]}function z6(Hh,Ih,Jh,Kh){var Lh={},Mh=Jh!==s6?Jh:1,Nh=Kh!==s6?Kh:1,Oh=Mh+Nh*(1-Mh);for(var Ph in Hh)Lh[Ph]=(Hh[Ph]*Mh+Ih[Ph]*Nh*(1-Mh))/Oh;return Lh.a=Oh,Lh}function A6(Qh,Rh){var Sh=1;return Sh=Qh>=Rh?(Qh+.05)/(Rh+.05):(Rh+.05)/(Qh+.05),E6(100*Sh)/100}function B6(Th,Uh,Vh){return Th>Vh?Vh:Uh>Th?Uh:Th}var C6={rgb:{r:[0,255],g:[0,255],b:[0,255]},hsv:{h:[0,360],s:[0,100],v:[0,100]},hsl:{h:[0,360],s:[0,100],l:[0,100]},alpha:{alpha:[0,1]},HEX:{HEX:[0,16777215]}},D6=r6.Math,E6=D6.round,F6={},G6={},H6={r:.298954,g:.586434,b:.114612},I6={r:.2126,g:.7152,b:.0722},J6=function(Wh){this.colors={RND:{}},this.options={color:"rgba(0,0,0,0)",grey:H6,luminance:I6,valueRanges:C6},K6(this,Wh||{})},K6=function(Xh,Yh){var Zh,$h=Xh.options;L6(Xh);for(var _h in Yh)Yh[_h]!==s6&&($h[_h]=Yh[_h]);Zh=$h.customBG,$h.customBG="string"==typeof Zh?M6.txt2color(Zh).rgb:Zh,G6=t6(Xh.colors,$h.color,s6,!0)},L6=function(a7){F6!==a7&&(F6=a7,G6=a7.colors)};J6.prototype.setColor=function(b7,c7,d7){return L6(this),b7?t6(this.colors,b7,c7,s6,d7):(d7!==s6&&(this.colors.alpha=B6(d7,0,1)),v6(c7))},J6.prototype.setCustomBackground=function(e7){return L6(this),this.options.customBG="string"==typeof e7?M6.txt2color(e7).rgb:e7,t6(this.colors,s6,"rgb")},J6.prototype.saveAsBackground=function(){return L6(this),t6(this.colors,s6,"rgb",!0)},J6.prototype.toString=function(f7,g7){return M6.color2text((f7||"rgb").toLowerCase(),this.colors,g7)};var M6={txt2color:function(h7){var i7={},j7=h7.replace(/(?:#|\)|%)/g,"").split("("),k7=(j7[1]||"").split(/,\s*/),l7=j7[1]?j7[0].substr(0,3):"rgb",m7="";if(i7.type=l7,i7[l7]={},j7[1])for(var n7=3;n7--;)m7=l7[n7]||l7.charAt(n7),i7[l7][m7]=+k7[n7]/C6[l7][m7][1];else i7.rgb=M6.HEX2rgb(j7[0]);return i7.alpha=k7[3]?+k7[3]:1,i7},color2text:function(o7,p7,q7){var r7=q7!==!1&&E6(100*p7.alpha)/100,s7="number"==typeof r7&&q7!==!1&&(q7||1!==r7),t7=p7.RND.rgb,u7=p7.RND.hsl,v7="hex"===o7&&s7,w7="hex"===o7&&!v7,x7="rgb"===o7||v7,y7=x7?t7.r+", "+t7.g+", "+t7.b:w7?"#"+p7.HEX:u7.h+", "+u7.s+"%, "+u7.l+"%";return w7?y7:(v7?"rgb":o7)+(s7?"a":"")+"("+y7+(s7?", "+r7:"")+")"},RGB2HEX:function(z7){return((z7.r<16?"0":"")+z7.r.toString(16)+(z7.g<16?"0":"")+z7.g.toString(16)+(z7.b<16?"0":"")+z7.b.toString(16)).toUpperCase()},HEX2rgb:function(A7){return A7=A7.split(""),{r:+("0x"+A7[0]+A7[A7[3]?1:0])/255,g:+("0x"+A7[A7[3]?2:1]+(A7[3]||A7[1]))/255,b:+("0x"+(A7[4]||A7[2])+(A7[5]||A7[2]))/255}},hue2RGB:function(B7){var C7=6*B7,D7=~~C7%6,E7=6===C7?0:C7-D7;return{r:E6(255*[1,1-E7,0,0,E7,1][D7]),g:E6(255*[E7,1,1,1-E7,0,0][D7]),b:E6(255*[0,0,E7,1,1,1-E7][D7])}},rgb2hsv:function(F7){var G7,H7,I7,J7=F7.r,K7=F7.g,L7=F7.b,M7=0;return L7>K7&&(K7=L7+(L7=K7,0),M7=-1),H7=L7,K7>J7&&(J7=K7+(K7=J7,0),M7=-2/6-M7,H7=D6.min(K7,L7)),G7=J7-H7,I7=J7?G7/J7:0,{h:1e-15>I7?G6&&G6.hsl&&G6.hsl.h||0:G7?D6.abs(M7+(K7-L7)/(6*G7)):0,s:J7?G7/J7:G6&&G6.hsv&&G6.hsv.s||0,v:J7}},hsv2rgb:function(N7){var O7=6*N7.h,P7=N7.s,Q7=N7.v,R7=~~O7,S7=O7-R7,T7=Q7*(1-P7),U7=Q7*(1-S7*P7),V7=Q7*(1-(1-S7)*P7),W7=R7%6;return{r:[Q7,U7,T7,T7,V7,Q7][W7],g:[V7,Q7,Q7,U7,T7,T7][W7],b:[T7,T7,V7,Q7,Q7,U7][W7]}},hsv2hsl:function(X7){var Y7=(2-X7.s)*X7.v,Z7=X7.s*X7.v;return Z7=X7.s?1>Y7?Y7?Z7/Y7:0:Z7/(2-Y7):0,{h:X7.h,s:X7.v||Z7?Z7:G6&&G6.hsl&&G6.hsl.s||0,l:Y7/2}},rgb2hsl:function($7,_7){var ai=M6.rgb2hsv($7);return M6.hsv2hsl(_7?ai:G6.hsv=ai)},hsl2rgb:function(bi){var ci=6*bi.h,di=bi.s,ei=bi.l,fi=.5>ei?ei*(1+di):ei+di-di*ei,gi=ei+ei-fi,hi=fi?(fi-gi)/fi:0,ii=~~ci,ji=ci-ii,ki=fi*hi*ji,li=gi+ki,mi=fi-ki,ni=ii%6;return{r:[fi,mi,gi,gi,li,fi][ni],g:[li,fi,fi,mi,gi,gi][ni],b:[gi,gi,li,fi,fi,mi][ni]}}};return J6}),function(oi,pi){"object"==typeof exports?module.exports=pi(oi,require("jquery"),require("colors")):"function"==typeof define&&define.amd?define(["jquery","colors"],function(qi,ri){return pi(oi,qi,ri)}):pi(oi,oi.jQuery,oi.Colors)}(this,function(si,ti,ui,vi){"use strict";function wi(a8){return a8.value||a8.getAttribute("value")||ti(a8).css("background-color")||"#FFF"}function xi(b8){return b8=b8.originalEvent&&b8.originalEvent.touches?b8.originalEvent.touches[0]:b8,b8.originalEvent?b8.originalEvent:b8}function yi(c8){return ti(c8.find(Ji.doRender)[0]||c8[0])}function zi(d8){var e8=ti(this),f8=e8.offset(),g8=ti(si),h8=Ji.gap;d8?(Ki=yi(e8),Ki._colorMode=Ki.data("colorMode"),Hi.$trigger=e8,(Li||Ai()).css(Ji.positionCallback.call(Hi,e8)||{left:(Li._left=f8.left)-((Li._left+=Li._width-(g8.scrollLeft()+g8.width()))+h8>0?Li._left+h8:0),top:(Li._top=f8.top+e8.outerHeight())-((Li._top+=Li._height-(g8.scrollTop()+g8.height()))+h8>0?Li._top+h8:0)}).show(Ji.animationSpeed,function(){d8!==!0&&(Qi.toggle(!!Ji.opacity)._width=Qi.width(),Ni._width=Ni.width(),Ni._height=Ni.height(),Mi._height=Mi.height(),Ii.setColor(wi(Ki[0])),Fi(!0))}).off(".tcp").on(Vi,".cp-xy-slider,.cp-z-slider,.cp-alpha",Bi)):Hi.$trigger&&ti(Li).hide(Ji.animationSpeed,function(){Fi(!1),Hi.$trigger=null}).off(".tcp")}function Ai(){return ti("head")[Ji.cssPrepend?"prepend":"append"]('<style type="text/css" id="tinyColorPickerStyles">'+(Ji.css||$i)+(Ji.cssAddon||"")+"</style>"),ti(Zi).css({margin:Ji.margin}).appendTo("body").show(0,function(){Hi.$UI=Li=ti(this),Xi=Ji.GPU&&Li.css("perspective")!==vi,Mi=ti(".cp-z-slider",this),Ni=ti(".cp-xy-slider",this),Oi=ti(".cp-xy-cursor",this),Pi=ti(".cp-z-cursor",this),Qi=ti(".cp-alpha",this),Ri=ti(".cp-alpha-cursor",this),Ji.buildCallback.call(Hi,Li),Li.prepend("<div>").children().eq(0).css("width",Li.children().eq(0).width()),Li._width=this.offsetWidth,Li._height=this.offsetHeight}).hide()}function Bi(i8){var j8=this.className.replace(/cp-(.*?)(?:\s*|$)/,"$1").replace("-","_");(i8.button||i8.which)>1||(i8.preventDefault&&i8.preventDefault(),i8.returnValue=!1,Ki._offset=ti(this).offset(),(j8="xy_slider"===j8?Ci:"z_slider"===j8?Di:Ei)(i8),Fi(),Si.on(Wi,function(){Si.off(".tcp")}).on(Ui,function(k8){j8(k8),Fi()}))}function Ci(l8){var m8=xi(l8),n8=m8.pageX-Ki._offset.left,o8=m8.pageY-Ki._offset.top;Ii.setColor({s:n8/Ni._width*100,v:100-o8/Ni._height*100},"hsv")}function Di(p8){var q8=xi(p8).pageY-Ki._offset.top;Ii.setColor({h:360-q8/Mi._height*360},"hsv")}function Ei(r8){var s8=xi(r8).pageX-Ki._offset.left,t8=s8/Qi._width;Ii.setColor({},"rgb",t8)}function Fi(u8){var v8=Ii.colors,w8=v8.hueRGB,x8=(v8.RND.rgb,v8.RND.hsl,Ji.dark),y8=Ji.light,z8=Ii.toString(Ki._colorMode,Ji.forceAlpha),A8=v8.HUELuminance>.22?x8:y8,B8=v8.rgbaMixBlack.luminance>.22?x8:y8,C8=(1-v8.hsv.h)*Mi._height,D8=v8.hsv.s*Ni._width,E8=(1-v8.hsv.v)*Ni._height,F8=v8.alpha*Qi._width,G8=Xi?"translate3d":"",H8=Ki[0].value,I8=Ki[0].hasAttribute("value")&&""===H8&&u8!==vi;Ni._css={backgroundColor:"rgb("+w8.r+","+w8.g+","+w8.b+")"},Oi._css={transform:G8+"("+D8+"px, "+E8+"px, 0)",left:Xi?"":D8,top:Xi?"":E8,borderColor:v8.RGBLuminance>.22?x8:y8},Pi._css={transform:G8+"(0, "+C8+"px, 0)",top:Xi?"":C8,borderColor:"transparent "+A8},Qi._css={backgroundColor:"#"+v8.HEX},Ri._css={transform:G8+"("+F8+"px, 0, 0)",left:Xi?"":F8,borderColor:B8+" transparent"},Ki._css={backgroundColor:I8?"":z8,color:I8?"":v8.rgbaMixBGMixCustom.luminance>.22?x8:y8},Ki.text=I8?"":H8!==z8?z8:"",u8!==vi?Gi(u8):Yi(Gi)}function Gi(J8){Ni.css(Ni._css),Oi.css(Oi._css),Pi.css(Pi._css),Qi.css(Qi._css),Ri.css(Ri._css),Ji.doRender&&Ki.css(Ki._css),Ki.text&&Ki.val(Ki.text),Ji.renderCallback.call(Hi,Ki,"boolean"==typeof J8?J8:vi)}var Hi,Ii,Ji,Ki,Li,Mi,Ni,Oi,Pi,Qi,Ri,Si=ti(document),Ti=ti(),Ui="touchmove.tcp mousemove.tcp pointermove.tcp",Vi="touchstart.tcp mousedown.tcp pointerdown.tcp",Wi="touchend.tcp mouseup.tcp pointerup.tcp",Xi=!1,Yi=si.requestAnimationFrame||si.webkitRequestAnimationFrame||function(K8){K8()},Zi='<div class="cp-color-picker"><div class="cp-z-slider"><div class="cp-z-cursor"></div></div><div class="cp-xy-slider"><div class="cp-white"></div><div class="cp-xy-cursor"></div></div><div class="cp-alpha"><div class="cp-alpha-cursor"></div></div></div>',$i=".cp-color-picker{position:absolute;overflow:hidden;padding:6px 6px 0;background-color:#444;color:#bbb;font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:400;cursor:default;border-radius:5px}.cp-color-picker>div{position:relative;overflow:hidden}.cp-xy-slider{float:left;height:128px;width:128px;margin-bottom:6px;background:linear-gradient(to right,#FFF,rgba(255,255,255,0))}.cp-white{height:100%;width:100%;background:linear-gradient(rgba(0,0,0,0),#000)}.cp-xy-cursor{position:absolute;top:0;width:10px;height:10px;margin:-5px;border:1px solid #fff;border-radius:100%;box-sizing:border-box}.cp-z-slider{float:right;margin-left:6px;height:128px;width:20px;background:linear-gradient(red 0,#f0f 17%,#00f 33%,#0ff 50%,#0f0 67%,#ff0 83%,red 100%)}.cp-z-cursor{position:absolute;margin-top:-4px;width:100%;border:4px solid #fff;border-color:transparent #fff;box-sizing:border-box}.cp-alpha{clear:both;width:100%;height:16px;margin:6px 0;background:linear-gradient(to right,#444,rgba(0,0,0,0))}.cp-alpha-cursor{position:absolute;margin-left:-4px;height:100%;border:4px solid #fff;border-color:#fff transparent;box-sizing:border-box}",_i=function(L8){Ii=this.color=new ui(L8),Ji=Ii.options,Hi=this};_i.prototype={render:Fi,toggle:zi},ti.fn.colorPicker=function(M8){var N8=this,O8=function(){};return M8=ti.extend({animationSpeed:150,GPU:!0,doRender:!0,customBG:"#FFF",opacity:!0,renderCallback:O8,buildCallback:O8,positionCallback:O8,body:document.body,scrollResize:!0,gap:4,dark:"#222",light:"#DDD"},M8),!Hi&&M8.scrollResize&&ti(si).on("resize.tcp scroll.tcp",function(){Hi.$trigger&&Hi.toggle.call(Hi.$trigger[0],!0)}),Ti=Ti.add(this),this.colorPicker=Hi||new _i(M8),this.options=M8,ti(M8.body).off(".tcp").on(Vi,function(P8){-1===Ti.add(Li).add(ti(Li).find(P8.target)).index(P8.target)&&zi()}),this.on("focusin.tcp click.tcp",function(Q8){Hi.color.options=ti.extend(Hi.color.options,Ji=N8.options),zi.call(this,Q8)}).on("change.tcp",function(){Ii.setColor(this.value||"#FFF"),N8.colorPicker.render(!0)}).each(function(){var R8=wi(this),S8=R8.split("("),T8=yi(ti(this));T8.data("colorMode",S8[1]?S8[0].substr(0,3):"HEX").attr("readonly",Ji.preventFocus),M8.doRender&&T8.css({"background-color":R8,color:function(){return Ii.setColor(R8).rgbaMixBGMixCustom.luminance>.22?M8.dark:M8.light}})})},ti.fn.colorPicker.destroy=function(){ti("*").off(".tcp"),Hi.toggle(!1),Ti=ti()}});var NumcounterPlugin={render:function(region,tmpObj,paraData){var onchange=tmpObj.attr("onchange");tmpObj.addClass("wrapped");tmpObj.addClass("num");var step=tmpObj.attr("step");try{step=parseInt(step)}catch(e){}if(step==null)step=1;var min=tmpObj.attr("min");try{min=parseInt(min)}catch(e){}var max=tmpObj.attr("max");try{max=parseInt(max)}catch(e){}if(paraData==null||paraData==""){paraData=0}if(paraData<min){paraData=min}if(paraData>max){paraData=max}var replaceHtml='<div class="numcounter-wrapper region-wrapper">';replaceHtml+='<div class="minus"><i class="fa-solid fa-minus"></i></div>';replaceHtml+=tmpObj.prop("outerHTML");replaceHtml+='<div class="plus"><i class="fa-solid fa-plus"></i></div>';replaceHtml+="</div>";var replaced=$(replaceHtml);RegionUtil.addRegionUniqueId(replaced[0],region.regionId);tmpObj.replaceWith(replaced);replaced.find(".minus").click(function(){var oldVal=0;if(min!=null)oldVal=min;try{oldVal=parseInt(replaced.find(".wrapped").val());if(isNaN(oldVal))oldVal=0}catch(e){}var newVal=oldVal-step;if(min!=null&&newVal<min)newVal=min;var wrapped=replaced.find(".wrapped");wrapped.val(newVal);if(onchange!=null&&onchange!=""){eval(onchange+".call(wrapped,newVal)")}});replaced.find(".plus").click(function(){var oldVal=0;if(min!=null)oldVal=min;try{oldVal=parseInt(replaced.find(".wrapped").val());if(isNaN(oldVal))oldVal=0}catch(e){}var newVal=oldVal+step;if(max!=null&&newVal>max)newVal=max;var wrapped=replaced.find(".wrapped");wrapped.val(newVal);if(onchange!=null&&onchange!=""){eval(onchange+".call(wrapped,newVal)")}});tmpObj=replaced.find(".wrapped");tmpObj.on("input",function(){var newVal=null;var wrapped=replaced.find(".wrapped");try{newVal=parseInt(wrapped.val());if(min>newVal){newVal=min;wrapped.val(newVal)}}catch(e){}if(onchange!=null&&onchange!=""){eval(onchange+".call(wrapped,newVal)")}});tmpObj.bind("input",function(){var U8=this.value.replace(/[^\d]/g,"");if(max!=null&&U8>max){this.value=max}else this.value=U8});tmpObj.val(paraData);return tmpObj},updateVal:function(V8,W8,X8,Y8){X8.val(Y8)}};var SliderPlugin={render:function(Z8,$8,_8){$8.addClass("wrapped");$8.attr("type","hidden");if(_8==null||_8==""){_8=0}var aj=$8.prop("outerHTML");var bj=$8.attr("width");if(bj==null)bj="100px";var cj='<div class="slider-wrapper region-wrapper">'+aj;cj+='<div class="bar-container"><div class="bar-actived"></div><div class="bar-control"></div></div>';cj+='<div class="val-prompt"></div>';cj+="</div>";var dj=$(cj);RegionUtil.addRegionUniqueId(dj[0],Z8.regionId);$8.replaceWith(dj);var ej=dj.find(".bar-control");dj.css("width",bj);setTimeout(function(){SliderPlugin.renderWithVal(dj,_8)});dj.find(".bar-container").click(function(fj){var gj=fj.clientX-(RegionUtil.getDomPosition(ej[0]).x+10);var hj=dj.find(".bar-actived").css("width");hj=parseInt(hj.substring(0,hj.length-2));var ij=hj+gj;dj.find(".bar-actived").css("width",ij+"px");ej.css("left",ij-8+"px");SliderPlugin.calculateVal(dj)});ej.mousedown(function(jj){var kj=$(this);kj.attr("start",jj.clientX);kj.attr("startWidth",dj.find(".bar-actived").css("width"));var lj=dj.find(".bar-container").css("width");lj=parseInt(lj.substring(0,lj.length-2));dj.mousemove(function(mj){var nj=mj.clientX-parseInt(kj.attr("start"));var oj=kj.attr("startWidth");oj=parseInt(oj.substring(0,oj.length-2));var pj=oj+nj;if(pj>lj){pj=lj}else if(pj<0){pj=0}dj.find(".bar-actived").css("width",pj+"px");kj.css("left",pj-8+"px");SliderPlugin.calculateVal(dj)});$(Z8.getRegionDivElem()).mouseout(function(qj){if(qj.fromElement==Z8.getRegionDivElem()){kj.attr("start",null);kj.attr("startWidth",null);dj.unbind("mousemove");$(Z8.getRegionDivElem()).unbind("mouseout");$(Z8.getRegionDivElem()).unbind("mouseup");SliderPlugin.calculateVal(dj)}});$(Z8.getRegionDivElem()).mouseup(function(rj){kj.attr("start",null);kj.attr("startWidth",null);dj.unbind("mousemove");$(Z8.getRegionDivElem()).unbind("mouseout");$(Z8.getRegionDivElem()).unbind("mouseup");SliderPlugin.calculateVal(dj)})});$8=dj.find(".wrapped");$8.val(_8);dj.find(".val-prompt").text(_8);return $8},renderWithVal:function(sj,tj){var uj=sj.find(".wrapped");var vj=uj.attr("min");try{vj=parseInt(vj)}catch(Bj){}if(vj==null)vj=0;var wj=uj.attr("max");try{wj=parseInt(wj)}catch(Cj){}if(wj==null)wj=100;if(tj<vj)tj=vj;else if(tj>wj)tj=wj;var xj=sj.find(".bar-container").width();var yj=xj/(wj-vj);var zj=sj.find(".bar-control");var Aj=yj*(tj-vj);sj.find(".bar-actived").css("width",Aj);zj.css("left",Aj-zj.outerWidth(true)/2-2)},calculateVal:function(wrapperElemObj){var tmpObj=wrapperElemObj.find(".wrapped");var min=tmpObj.attr("min");try{min=parseInt(min)}catch(e){}if(min==null)min=0;var max=tmpObj.attr("max");try{max=parseInt(max)}catch(e){}if(max==null)max=100;var maxWidth=wrapperElemObj.find(".bar-container").css("width");maxWidth=parseInt(maxWidth.substring(0,maxWidth.length-2));var curWidth=wrapperElemObj.find(".bar-actived").css("width");curWidth=parseInt(curWidth.substring(0,curWidth.length-2));var curVal=curWidth/maxWidth*(max-min)+min;curVal=Math.round(curVal);tmpObj.val(curVal);SliderPlugin.renderWithVal(wrapperElemObj,curVal);wrapperElemObj.find(".val-prompt").text(curVal);var onchange=tmpObj.attr("onchange");if(onchange!=null&&onchange!=""){eval(onchange+".call(tmpObj,curVal)")}},updateVal:function(Dj,Ej,Fj,Gj){Fj.val(Gj)}};var TimePickerPlugin={render:function(Hj,Ij,Jj){var Kj=Ij.attr("width");Ij.addClass("wrapped");var Lj='<div class="timepicker-wrapper region-wrapper">'+Ij.prop("outerHTML");Lj+="<div></div>";Lj+="</div>";var Mj=$(Lj);RegionUtil.addRegionUniqueId(Mj[0],Hj.regionId);Ij.replaceWith(Mj);if(Kj!=null){Mj.css("width",Kj)}Ij=Mj.find(".wrapped");var Nj=Ij.attr("format");if(Nj==null||Nj==""){Nj="HH:mm:ss"}Ij.attr("placeholder",Nj);var Oj=new HashMap;RS.addDialog(Ij,"common/shared/date/core/time-picker.rs",Oj,function(Pj,Qj){Qj.put("timeFormat",Nj);Qj.put("initTime",Pj.val())},function(Rj,Sj){Rj.onOkClick=function(Tj){Sj.val(Tj);RS.tryCloseDialog(Sj,0)};Rj.onNowClick=function(Uj){Sj.val(Uj);RS.tryCloseDialog(Sj,0)}});Ij.val(Jj);return Ij},updateVal:function(Vj,Wj,Xj,Yj){Xj.val(Yj)}};var RegionTagPlugin={render:function(Zj,$j,_j){var a9=$j.attr("resType");var b9=$j.attr("width");var c9=$j.attr("height");var d9=$j.attr("region-uuid");var e9=$j.attr("region-id");var f9=$('<div class="inner-region" region-id="'+e9+'"></div>');if(c9==null)c9="100%";if(b9==null)b9="100%";f9.css("height",c9);f9.css("width",b9);var g9=null;if(d9==null){d9=RegionUtil.getUUID()}g9=e9+"_"+d9;var h9=$j.attr("region-attr");f9.attr("region-attr",h9);if(a9==null)a9="relativeUrl";var i9=$j.attr("res");if(a9=="html"&&i9!=null){var j9=null;i9=i9.replaceAll("region_"+e9,"REGION");RegionUtil.loadRegionByContent(f9,null,i9,j9,g9)}else if(a9=="json"){var j9=null;RegionUtil.loadRegionByConfig(f9,JSON.parse(i9),j9,g9)}else if(a9=="relativeUrl"){RegionUtil.loadRegion(f9,RegionUtil.appendParaObjectToUrl(i9,_j),g9)}else if(a9=="absoluteUrl"){RegionUtil.loadAbsRegion(f9,RegionUtil.appendParaObjectToUrl(i9,_j),g9)}else if(a9=="repo"){if(Config.rsRepo==null){Config.rsRepo="http://cdn.rcsdn.cn/rsrepo/"}RegionUtil.loadAbsRegion(f9,RegionUtil.appendParaObjectToUrl(Config.rsRepo+i9,_j),g9)}$j.replaceWith(f9);return f9},updateVal:function(k9,l9,m9,n9){},packData:function(o9){var p9=o9.children()[0].getAttribute("region-id");var q9=RegionUtil.getRegionById(p9);if(q9==null)return null;if(q9.type=="RegionForm"){var r9=q9.packFormData();return r9}else return null}};var ItemsinputPlugin={render:function(s9,t9,u9){var v9=t9.attr("onchange");if(v9==null)v9="";var w9=t9.attr("hide");if("true"==w9){t9.closest(".data-block-wrapper").addClass("hidden")}t9.addClass("wrapped");t9.attr("type","hidden");var x9=t9.prop("outerHTML");t9.attr("type","text");t9.removeClass("wrapped");t9.attr("region-attr",null);t9.removeClass("region-editable");t9.addClass("inputarea");var y9=t9.attr("width");if(y9!=null){t9.css("width",y9)}var z9=t9.attr("label");var A9=null;if(z9==null){A9='<div class="items-input-wrapper region-wrapper">'+x9+t9.prop("outerHTML")}else{A9='<div class="items-input-wrapper region-wrapper"><span class="wrapped-label">'+z9+"</span>"+x9+t9.prop("outerHTML")}A9+='\t<div class="items"></div>';A9+="</div>";var B9=$(A9);if(y9!=null){B9.css("width",y9)}RegionUtil.addRegionUniqueId(B9[0],s9.regionId);t9.replaceWith(B9);ItemsinputPlugin.renderItems(B9,u9);B9.find(".inputarea").keyup(function(C9){if(C9.which==13){var D9=$(this).val().trim();if(D9!=""){ItemsinputPlugin.appendItems(B9,D9)}}});B9.find(".inputarea").blur(function(){var E9=$(this).val().trim();if(E9!=""){ItemsinputPlugin.appendItems(B9,E9)}});return t9},updateVal:function(F9,G9,H9,I9){ItemsinputPlugin.renderItems(G9,I9)},renderItems:function(J9,K9){var L9=RegionUtil.getRegionByElem(J9[0]);J9.find(".wrapped").val(K9);var M9="";if(K9==null||K9.trim()==""){J9.find(".items").html("")}else{var N9=K9.split(",");for(var O9=0;O9<N9.length;O9++){if(N9[O9].trim()=="")continue;M9+='<div class="item">'+N9[O9]+'<i class="fa-solid fa-remove" onclick="ItemsinputPlugin.removeItem(event)"></i></div>'}RegionUtil.setInnerHtml(L9,J9.find(".items")[0],M9)}},appendItems:function(P9,Q9){var R9=RegionUtil.getRegionByElem(P9[0]);var S9=P9.find(".wrapped").val();var T9={};if(S9!=null&&S9.trim()!=""){var U9=S9.split(",");for(var V9=0;V9<U9.length;V9++){if(U9[V9].trim()=="")continue;T9[U9[V9]]=true}}var W9="";if(Q9!=null&&Q9.trim()!=""){var U9=Q9.split(",");for(var V9=0;V9<U9.length;V9++){if(U9[V9].trim()==""||T9[U9[V9]]==true)continue;W9+='<div class="item">'+U9[V9]+'<i class="fa-solid fa-remove" onclick="ItemsinputPlugin.removeItem(event)"></i></div>';T9[U9[V9]]=true}RegionUtil.appendHtml(R9,P9.find(".items")[0],W9)}var X9="";for(x in T9){X9+=x+","}if(X9.endWith(","))X9=X9.substring(0,X9.length-1);P9.find(".wrapped").val(X9);P9.find(".inputarea").val("")},removeItem:function(Y9){var Z9=RegionUtil.getEventTarget(Y9);var $9=$(Z9).parent();var _9=$9.text();var ak=$9.closest(".items-input-wrapper");var bk=ak.find(".wrapped").val();var ck={};if(bk!=null&&bk.trim()!=""){var dk=bk.split(",");for(var ek=0;ek<dk.length;ek++){if(dk[ek].trim()==""||_9==dk[ek])continue;ck[dk[ek]]=true}}var fk="";for(x in ck){fk+=x+","}if(fk.endWith(","))fk=fk.substring(0,fk.length-1);ak.find(".wrapped").val(fk);$9.remove()}};var DynamicFormTemplates={emptyStaticRegionHtml:'<div id="REGION" class="hidden">\n'+"Sample Region\n"+"</div>\t\n"+'<script type="text/javascript">\n'+"RegionUtil.ready(function(){\n"+'\tvar staticRegion = RegionUtil.newStaticRegion("#REGION");\n'+"\tstaticRegion.renderRegion();\n"+"})\n"+"<\/script>",configuredRegionFormHtml:'<div id="REGION" class="hidden"></div>',configuredRegionFormScript:'<script type="text/javascript">\n'+"\t\tvar REGION = {\n"+"@FUNC_HOLDER\n"+"\t\t};\n"+"\t\tRegionUtil.ready(function(){\n"+"\t\t\tvar res = {\n"+"\t\t\t    dataList:{\n"+"\t\t\t    \t\tdft:{\n"+"\t\t\t\t\t\t\t@DS_HOLDER\n"+"\t\t\t\t\t\t}\n"+"\t\t\t\t}\n"+"\t\t\t};\n"+'\t\t\tvar formRegion = RegionUtil.newFormRegion("#REGION",res);\n'+"\t\t\t@VALIDATOR_HOLDER\n"+"\t\t\t@CONFIG_HOLDER\n"+"\t\t\tformRegion.renderRegion();\n"+"\t\t\t@INITATTR_HOLDER\n"+"})\n"+"<\/script>",configuredRegionBtns:'<div class="data-block-ctrl"><span class="form-btn" onclick="REGION.validate(event)">验证表单</span><span class="form-btn" onclick="REGION.getFormData(event)">表单数据</span><span class="form-btn hidden" title="reset" onclick="REGION.reset(event)">重置</span></div>',spliterHtml:'<div class="spliter"></div>',sectionHtml:'<div class="section"><div class="section-content"></div></div>',textHtml:'<input type="text" region-attr="property" class="form-control region-editable" maxlength="20" width="200px">',"m-textHtml":'<input type="text" region-attr="property" class="multi-text form-control region-editable" maxlength="20" width="400px" height="200px">',"s-select":'<select region-attr="property" class="form-control region-editable" width="200px" region-ds="SampleOptions"></select>',"m-selectHtml":'<select type="multiple" region-attr="property" class="form-control region-editable" width="200px" region-ds="SampleOptions"></select>',"s-chooseHtml":'<input type="radio" region-attr="property" class="form-control region-editable" region-ds="SampleOptions">',"m-chooseHtml":'<input type="checkbox" region-attr="property" class="form-control region-editable" region-ds="SampleOptions">',dateHtml:'<input type="text" region-attr="property" class="date form-control region-editable" width="200px" format="YYYY-MM-DD" locale="cn">',starHtml:'<input type="text" region-attr="property" class="star form-control region-editable" max-score="5">',switchHtml:'<input type="text" region-attr="property" class="switch form-control region-editable" active-text="开"  inactive-text="关">',richinputHtml:'<input type="text" region-attr="property" class="richinput form-control region-editable" width="80%">',fileHtml:'<input type="file" region-attr="property"  class="region-editable"  paras="maxsize=2000;accept=*" vendor="local" download-able="true">',imgHtml:'<input region-attr="property" class="img region-editable" paras="maxsize=2000;accept=*" vendor="local" download-able="true">',transferHtml:'<input type="text" class="transfer region-editable" region-attr="property" source-title="待选项"  result-title="被选项" width="500px" height="200px">',edittableHtml:'<input type="text" region-attr="property" class="editable-table form-control region-editable" max-rows="5" width="auto">',colorpickerHtml:'<input type="text" class="colorpicker region-editable" region-attr="property">',numcounterHtml:'<input type="text" class="numcounter region-editable" region-attr="property" step="1">',sliderHtml:'<input type="text" class="slider region-editable" region-attr="property" width="200px" min="0" max="10">',timepickerHtml:'<input type="text" class="timepicker form-control region-editable" region-attr="property">',"view-textHtml":'<span class="view-text region-editable" region-attr="property"></span>',"view-dsHtml":'<span class="view-ds region-editable" region-attr="property" region-ds="SampleOptions"></span>',"view-barcodeHtml":'<view class="barcode region-editable" region-attr="property" height="50px"></view>',"view-qrcodeHtml":'<view class="qrcode region-editable" region-attr="property"></view>',"view-codeHtml":'<view class="code region-editable" region-attr="property" width="100%" name="BookService.java"></view>',editorHtml:'<region resType="relativeUrl" res="tools/formeditor/form-editor-index.rs"></region>',regionTreeHtml:'<region resType="relativeUrl" res="samples/examples/tree/simple-tree-example.rs"></region>',regionSelectableTreeHtml:'<region resType="relativeUrl" res="samples/examples/tree/checkbox-tree-example.rs"></region>',regionMenuHtml:'<region resType="relativeUrl" res="samples/examples/stackmenu/stackmenu-example.rs"></region>',regionHtml:'<region resType="html" region-attr="property" class="region-editable"></region>',blockHtmlStartPart_Editable:'<div class="data-block-wrapper editable" style="width:blockWidth;" draggable="false">'+'\t\t\t<div class="data-block titlePosition readonly" style="width:100%;">'+'\t\t\t    <div class="field-label">'+"\t\t\t    <label>LABEL</label>"+"\t\t\t    </div>"+'\t\t\t    <div class="field-val">',blockHtmlEndPart_Editable:"\t\t</div>"+"\t\t\t</div>"+'\t\t\t<div class="block-control hidden"><i class="fa fa-copy"></i><i class="fa-solid fa-trash-alt"></i></div>'+"\t\t</div>",plainBlockHtmlStartPart_Editable:'<div class="data-block-wrapper editable" style="width:blockWidth;" draggable="false">'+'\t\t\t<div class="data-block readonly" style="width:100%;">',plainBlockHtmlEndPart_Editable:"\t\t\t</div>"+'\t\t\t<div class="block-control hidden"><i class="fa fa-copy"></i><i class="fa-solid fa-trash-alt"></i></div>'+"\t\t</div>",blockHtmlStartPart:'<div class="data-block-wrapper" style="width:blockWidth;">'+'\t\t\t<div class="data-block titlePosition" style="width:100%;">'+'\t\t\t    <div class="field-label">'+"\t\t\t    \t <label>LABEL</label>"+"\t\t\t    </div>"+'\t\t\t    <div class="field-val">',blockHtmlEndPart:"\t\t</div>"+"\t\t\t</div>"+"\t\t</div>",plainBlockHtmlStartPart:'<div class="data-block-wrapper" style="width:blockWidth;">'+'\t\t\t<div class="data-block" style="width:100%;">',plainBlockHtmlEndPart:"\t\t\t</div>"+"\t\t</div>",getHtmlForItem:function(gk,hk,ik,jk,kk,lk,mk){var nk="";if(gk==true){nk="_Editable"}var ok=null;if(hk=="spliter"){ok=DynamicFormTemplates["plainBlockHtmlStartPart"+nk]+DynamicFormTemplates.spliterHtml+DynamicFormTemplates["plainBlockHtmlEndPart"+nk];ok=ok.replace("blockWidth","100%");ok=ok.replace("data-block-wrapper","data-block-wrapper horizontal-line")}else if(hk=="section"){ok=DynamicFormTemplates["plainBlockHtmlStartPart"+nk]+DynamicFormTemplates.sectionHtml+DynamicFormTemplates["plainBlockHtmlEndPart"+nk];ok=ok.replace("blockWidth","100%")}else if(hk=="region"){ok=DynamicFormTemplates["plainBlockHtmlStartPart"+nk];if(ik=="tree"){ok+=DynamicFormTemplates.regionTreeHtml}else if(ik=="selectable-tree"){ok+=DynamicFormTemplates.regionSelectableTreeHtml}else if(ik=="menu"){ok+=DynamicFormTemplates.regionMenuHtml}else if(ik=="editor"){ok+=DynamicFormTemplates.editorHtml}else{ok+=DynamicFormTemplates.regionHtml}ok+=DynamicFormTemplates["plainBlockHtmlEndPart"+nk].replace("fa-copy","fa-copy hidden")}else{ok=DynamicFormTemplates["blockHtmlStartPart"+nk];if(kk==0){ok=ok.replace("titlePosition","right-title")}else if(kk==1){ok=ok.replace("titlePosition","left-title")}else if(kk==2){ok=ok.replace("titlePosition","top-title")}ok=ok.replace("blockWidth",lk);if(hk=="text"){ok+=DynamicFormTemplates.textHtml;ok=ok.replace("LABEL",jk)}else if(hk=="m-text"){ok+=DynamicFormTemplates["m-textHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="s-select"){ok+=DynamicFormTemplates["s-select"];ok=ok.replace("LABEL",jk)}else if(hk=="m-select"){ok+=DynamicFormTemplates["m-selectHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="s-choose"){ok+=DynamicFormTemplates["s-chooseHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="m-choose"){ok+=DynamicFormTemplates["m-chooseHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="date"){ok+=DynamicFormTemplates["dateHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="star"){ok+=DynamicFormTemplates["starHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="switch"){ok+=DynamicFormTemplates["switchHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="richinput"){ok+=DynamicFormTemplates["richinputHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="file"){ok+=DynamicFormTemplates["fileHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="img"){ok+=DynamicFormTemplates["imgHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="colorpicker"){ok+=DynamicFormTemplates["colorpickerHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="transfer"){ok+=DynamicFormTemplates["transferHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="numcounter"){ok+=DynamicFormTemplates["numcounterHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="slider"){ok+=DynamicFormTemplates["sliderHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="timepicker"){ok+=DynamicFormTemplates["timepickerHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="edittable"){ok+=DynamicFormTemplates["edittableHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="view-text"){ok+=DynamicFormTemplates["view-textHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="view-ds"){ok+=DynamicFormTemplates["view-dsHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="view-barcode"){ok+=DynamicFormTemplates["view-barcodeHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="view-qrcode"){ok+=DynamicFormTemplates["view-qrcodeHtml"];ok=ok.replace("LABEL",jk)}else if(hk=="view-code"){ok+=DynamicFormTemplates["view-codeHtml"];ok=ok.replace("LABEL",jk)}}ok=ok.replace("property",mk);ok+=DynamicFormTemplates["blockHtmlEndPart"+nk];return ok},resolveListRegionContent:function(pk,qk,rk,sk){var tk=pk.tagItemConfigs;var uk="";var vk=new HashMap;var wk=[];var xk=null;var yk='<div id="REGION" class="hidden">';for(var zk=0;zk<tk.length;zk++){yk+='\t<input type="hidden" region-attr="'+tk[zk].fieldName+'" class="form-control region-searchable" maxlength="20">'}yk+='\t\t<div class="form">';yk+='\t\t\t<div class="form-info">';yk+='\t\t\t\t<div class="title">列表</div>';yk+='\t\t\t\t<div class="deleteopt"><button class="btn btn-info batch-delete hidden"><message key="global_msg.batch_delete"></message></button></div>';yk+='\t\t\t\t<div class="toolbar">';yk+='\t\t\t\t\t<i class="fa fa-plus grid-plus" title="add"></i>';yk+='\t\t\t\t\t<i class="fa fa-refresh region-refresh" title="refresh"></i>';yk+="\t\t\t\t</div>";yk+="\t\t\t</div>";yk+='\t\t<div class="form-body">';yk+='\t\t\t<div class="datas-columns header-row">';yk+='\t\t\t\t<div class="col-xs-1 maxwidth40"><input class="selectAll" type="checkbox"></div>';yk+='\t\t\t\t<div class="col-xs-1 maxwidth60"><message key="global_msg.index"></message></div>';for(var zk=0;zk<tk.length;zk++){var Ak=tk[zk].title;if(Ak.endWith(":"))Ak=Ak.substring(0,Ak.length-1);yk+='\t\t\t\t<div class="col-xs-1"><label>'+Ak+"</label></div>"}yk+='\t\t\t\t<div class="col-xs-2"><message key="global_msg.operation"></message></div>';yk+="\t\t\t</div>";yk+='\t\t\t<div class="datas" region-list="list">';yk+='\t\t\t\t<div class="row" onclick="RegionUtil.handleListData(event,REGION.onRowclick)">';yk+='\t\t\t\t\t<div class="col-xs-1 maxwidth40"><input type="checkbox" class="multipleCbs"></div>';yk+='\t\t\t\t\t<div class="col-xs-1 maxwidth60"><span region-attr="index"></span></div>';for(var zk=0;zk<tk.length;zk++){if(tk[zk].itemType=="s-select"||tk[zk].itemType=="m-select"||tk[zk].itemType=="s-choose"||tk[zk].itemType=="m-choose"){if(tk[zk].dataSrcType=="static"){var Bk="ds_"+tk[zk].fieldName;vk.put(Bk,JSON.stringify(tk[zk].staticDataSrc));yk+='\t\t\t\t<div class="col-xs-1"><span region-ds="'+Bk+'" region-attr="'+tk[zk].fieldName+'"></span></div>';continue}}yk+='\t\t\t\t<div class="col-xs-1"><span region-attr="'+tk[zk].fieldName+'"></span></div>'}yk+='\t\t\t\t\t<div class="col-xs-2">';yk+='\t\t\t\t\t\t<a href="javascript:void(0)" onclick="RegionUtil.handleListData(event,REGION.viewData)"><i class="fa fa-pencil fa-fw" title="编辑"></i></a>';yk+='\t\t\t\t\t<button class="btn" data-type="danger" plain onclick="RegionUtil.handleListData(event,REGION.deleteData)"><i class="fa-light fa-trash-alt" title="Delete"></i></button>';yk+="\t\t\t\t\t</div>";yk+="\t\t\t\t</div>";yk+="\t\t\t</div>";yk+='\t\t\t<div class="paginationControl"></div>';yk+='\t\t\t<div class="norecordmsg fa hidden"><message key="global_msg.no_record_found"></message></div>';yk+="\t\t</div>";yk+="\t</div>";yk+="</div>";var Ck=DynamicFormTemplates.resolveRegionContent(pk,qk,rk,sk);var Dk=RegionUtil.getRegionCachedUrlByContent(Ck);yk+='<script type="text/javascript">';yk+="var REGION = {";yk+="\t\tonRowclick:function(rowData){";yk+="\t\t\tif(this.rowClick!=null)this.rowClick(rowData);";yk+="\t\t},";yk+="\t\tviewData :function (rowData){";yk+="\t\t\tthis.viewRecord(rowData,this.regionId);";yk+="\t\t},";yk+="\t\tdeleteData:function(rowData){";yk+="\t\t\tthis.deleteData(rowData);";yk+="\t\t}";yk+="};";yk+="\tvar res = {";yk+="\t\tdataList:{";yk+="\t\t\tdft:{";if(vk.size()!=0){var Ek=vk.keySet();var Fk="";for(var zk=0;zk<Ek.length;zk++){Fk+=Ek[zk]+":"+vk.get(Ek[zk])+",\n"}yk+=Fk}yk+="\t\t\t}";yk+="\t\t}";yk+="\t};";yk+='\tvar gridRegion = RegionUtil.newGridRegion("#REGION",res);';yk+='\tgridRegion.resUrl = Config.backendPath+ "/subproject/cloud/form/'+sk+'/list";\t';yk+='\tgridRegion.addTitle = global_msg._new+"'+sk+'";';yk+='\tgridRegion.viewTitle = global_msg._edit+"'+sk+'";';yk+='\tgridRegion.reqRes = "'+Dk+'";';yk+="\tgridRegion.setRowClick = function(functionStrPara,para){";yk+='\t\tvar functionStr = "gridRegion.rowClick = function("+para+"){"+functionStrPara+"}";';yk+="\t\teval(functionStr);";yk+="\t};";yk+="\tgridRegion.search();\t";yk+="<\/script>";if(Config.REGION_DEBUG_MODE)console.log(yk);return yk},resolveRegionContent:function(Gk,Hk,Ik,Jk){if(typeof Gk=="string"){Gk=JSON.parse(Gk)}var Kk=Gk.tagItemConfigs;var Lk=Gk.globalConfig;if(Lk==null){Lk={}}var Mk=null;if(Lk.titlePosition=="1")Mk="left-title";else if(Lk.titlePosition=="2")Mk="top-title";else Mk="right-title";if(Lk.blockWidth=="50%")Mk+=" two-column";else if(Lk.blockWidth=="33.3%")Mk+=" three-column";else if(Lk.blockWidth=="25%")Mk+=" four-column";else Mk+=" one-column";var Nk="";var Ok=new HashMap;var Pk=new HashMap;var Qk=new HashMap;var Rk=[];if(Ik){Nk='<input region-attr="id" class="region-editable" type="hidden">';Nk+='<div class="form">';Nk+='\t<div class="form-info">';Nk+='\t\t<div class="title">'+Jk+"详细</div>";Nk+='\t\t<div class="toolbar">';Nk+='\t\t\t<i class="fa fa fa-save" title="save" onclick="REGION.saveRegion(event)"></i>';Nk+='\t\t\t<i class="fa fa fa-undo" title="reset" onclick="REGION.reset(event)"></i>';Nk+='\t\t\t<i class="fa fa-refresh region-refresh" title="refresh" onclick="REGION.refreshRegion(event)"></i>';Nk+="\t\t</div>";Nk+="\t</div>";Nk+='\t<div class="form-body '+Mk+'">'}else{Nk='<div class="match-parent '+Mk+'">'}for(var Sk=0;Sk<Kk.length;Sk++){var Tk=Kk[Sk];var Uk=Tk.jsonFormatAttrs;if(Uk!=null&&Uk.length>0){for(var Vk=0;Vk<Uk.length;Vk++){var Wk=Uk[Vk];Tk[Wk]=JSON.stringify(Tk[Wk])}}Nk+=DynamicFormTemplates.handleTagItemConfig(Tk,Ok,Qk,Pk,Rk)}if(Ik){Nk+="\t</div>";Nk+="</div>"}else{Nk+="</div>"}var Xk=DynamicFormTemplates.configuredRegionFormHtml;var Yk=$(Xk);var Zk=DynamicFormTemplates.configuredRegionFormScript;if(Ik){var $k='formRegion.resUrl = Config.backendPath+"/subproject/cloud/form/'+Jk+'/";formRegion.renderRegion();formRegion.saveSuccessCallBack = REGION.saveSuccessCallBack;formRegion.saveFailedCallBack = REGION.saveFailedCallBack;';Zk=Zk.replace("formRegion.renderRegion();",$k)}if(Qk.size()==0){Zk=Zk.replace("@DS_HOLDER","")}else{var _k=Qk.keySet();var al="";for(var Sk=0;Sk<_k.length;Sk++){al+=_k[Sk]+":"+Qk.get(_k[Sk])+",\n"}Zk=Zk.replace("@DS_HOLDER",al)}if(Pk.size()==0){Zk=Zk.replace("@CONFIG_HOLDER","")}else{var _k=Pk.keySet();var bl="";for(var Sk=0;Sk<_k.length;Sk++){bl+='\t\t\tformRegion.config("'+_k[Sk]+'",\n';bl+="\t\t\t\t"+Pk.get(_k[Sk])+"\n";bl+="\t\t\t);\n"}Zk=Zk.replace("@CONFIG_HOLDER",bl)}if(Ok.size()==0){Zk=Zk.replace("@INITATTR_HOLDER","")}else{var _k=Ok.keySet();var cl="";for(var Sk=0;Sk<_k.length;Sk++){cl+="\n\t\t\tformRegion.setAttr('"+_k[Sk]+"','"+Ok.get(_k[Sk])+"');"}Zk=Zk.replace("@INITATTR_HOLDER",cl)}if(Rk.length==0){Zk=Zk.replace("@VALIDATOR_HOLDER","")}else{var dl="";for(var Sk=0;Sk<Rk.length;Sk++){dl+=Rk[Sk]}dl+="\n";Zk=Zk.replace("@VALIDATOR_HOLDER",dl)}var el="";el+="validate:function(event){\n";el+="\tRegionUtil.getRegionByEvent(event).validate();\n";el+="},\n";el+="reset:function(event){\n";el+="RegionUtil.getRegionByEvent(event).reset();\n";el+="},\n";el+="getFormData:function(event){\n";el+="var formData = RegionUtil.getRegionByEvent(event).packFormData();\n";el+="var paraMap = new HashMap();\n";el+='paraMap.put("result",formData);\n';el+='RegionUtil.openModalWindow(RegionUtil.appendParaMapToUrl("tools/formeditor/modules/export-json-view.rs",paraMap),"表单数据",1,0.5,0.7,600);\n';el+="},\n";el+="saveRegion:function(event){";el+="\tvar tmpRegion = RegionUtil.getRegionByEvent(event);";el+="\ttmpRegion.saveOrUpdateRegion();";el+="},";el+="refreshRegion:function(event){";el+="\tvar tmpRegion = RegionUtil.getRegionByEvent(event);";el+="\ttmpRegion.refreshRegion();";el+="},";el+="saveSuccessCallBack:function(){";el+="\tif(parent!=null){";el+="\t\ttry{";el+="\t\t\tRegionUtil.alert(global_msg.save_successfully);";el+="\t\t\tif(this.isPopup()){";el+='\t\t\t\tRegionUtil.getWindowRegionById(parent.window,this.paraMap.get("refreshRegionId")).refreshRegion();';el+="\t\t\t\tparent.closeModalWindow();";el+="\t\t\t}";el+="\t\t}catch(e){";el+="\t\t\tconsole.log(e)";el+="\t\t}";el+="\t}";el+="},";el+="saveFailedCallBack:function(){";el+='\tconsole.log("save failed");';el+="}";Zk=Zk.replace("@FUNC_HOLDER",el);$(Yk.append(Nk).append(DynamicFormTemplates.configuredRegionBtns));if(Hk!=true){Yk.find(".data-block-ctrl").addClass("hidden")}var fl=Yk.prop("outerHTML")+Zk;return fl},handleTagItemConfig:function(gl,hl,il,jl,kl){var ll=gl.itemType;var ml=null;var nl=DynamicFormTemplates.getHtmlForItem(false,gl.itemType,gl.subType,gl.title,gl.titlePosition,gl.blockWidth,gl.fieldName);if(gl.itemType=="s-select"||gl.itemType=="m-select"||gl.itemType=="s-choose"||gl.itemType=="m-choose"){var ol=gl.dataSrcType;if(ol==null){}else if(ol=="static"){if(gl.staticDataSrc==null){}var pl="ds_"+gl.fieldName;il.put(pl,gl.staticDataSrc);nl=nl.replace("SampleOptions",pl)}else{nl=nl.replace("SampleOptions",gl.formDataSrc)}}else if(gl.itemType=="edittable"){if(gl.columns!=null){jl.put(gl.fieldName,JSON.stringify({columns:JSON.parse(gl.columns)}))}}else if(gl.itemType=="date"){if(gl.specialDays!=null){jl.put(gl.fieldName,JSON.stringify({specialDays:JSON.parse(gl.specialDays)}))}}else if(gl.itemType=="section"){console.log(gl);var ml=$(nl);var ql=ml.find(".section-content");if(gl.text!=null)ql.text(gl.text);ql.css("line-height",gl.lineheight);ql.css("font-size",gl.fontsize);ql.css("font-weight",gl.fontweight);ml.find(".section").css("background",gl.bgcolor);return ml.prop("outerHTML")+"\n"}else if(gl.itemType=="region"){ml=$(nl);var rl=ml.find("REGION");rl.attr("resType",gl.resType);rl.attr("res",gl.res);rl.attr("region-uuid",gl.uuid);rl.attr("region-attr",gl.fieldName);rl.attr("width",gl.width);rl.attr("height",gl.height)}if(gl["initData"]!=null){hl.put(gl.fieldName,gl["initData"])}var sl=[];var tl=[];if(gl.mandatory=="true"){sl.push(SysValidationTypes["100"].regx);tl.push(SysValidationTypes["100"].msg)}if(gl.validationType!=null&&gl.validationType!=0){sl.push(SysValidationTypes[gl.validationType].regx);tl.push(SysValidationTypes[gl.validationType].msg)}if(sl.length!=0){var ul='\n\t\t\tformRegion.addValidator("'+gl.fieldName+'",new Array(';for(var vl=0;vl<sl.length;vl++){ul+=sl[vl]+","}ul=ul.substring(0,ul.length-1);ul+="),new Array(";for(var vl=0;vl<tl.length;vl++){ul+="'"+tl[vl]+"',"}ul=ul.substring(0,ul.length-1);ul+="));";kl.push(ul)}if(ml==null)ml=$(nl);if(gl.itemType=="img"){var wl="maxsize="+gl.maxsize+";accept="+gl.accept;ml.find(".img").attr("paras",wl);delete gl.maxsize;delete gl.accept}else if(gl.itemType=="file"){var wl="maxsize="+gl.maxsize+";accept="+gl.accept;ml.find("input[type=file]").attr("paras",wl);delete gl.maxsize;delete gl.accept}delete gl.fieldName;delete gl.itemType;delete gl.subType;delete gl.titlePosition;delete gl.blockWidth;delete gl.jsonFormatAttrs;delete gl.datasrctype;delete gl.formdatasrc;delete gl.staticDataSrc;delete gl.columns;delete gl.specialDays;delete gl.initData;var xl=ml.find(".region-editable");for(x in gl){if(gl[x]!=null){xl.attr(x,gl[x])}}return ml.prop("outerHTML")+"\n"}};var ObjectSystemUtil={uploadFile:function(yl,zl,Al,Bl){ObjectSystemUtil.file=yl;if(zl==null)zl="common";var Cl=new jQuery.Deferred;var Dl=Cl.promise();if(Al==null)Al=Config.fileVendor;if(Al==null)Al="cloud";if(Bl!=null&&!Bl.endsWith("/"))Bl=Bl+"/";var El=RegionUtil.calculateMD5(yl);El.done(function(Fl){var Gl=new Object;Gl.md5=Fl;Gl.upToken=RegionUtil.getCookie("fileUpToken");Gl.fileType=zl;Gl.vendor=Al;Gl.storePath=Bl;RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Objectsystem/objectsystem/pre-upload","POST",Gl,function(Hl,Il){var Jl=Hl.data;if(!Jl.recordExsit){if(Jl.upToken!=null){RegionUtil.setCookieWithExpire("fileUpToken",Jl.upToken,"s"+60);Gl.upToken=Jl.upToken}if(Al=="local"){var Kl=ObjectSystemUtil.subUploadFileToLocal(Jl.fileKeyPrefix,Gl.md5,Gl.fileType);Kl.done(function(Ml){debugger;Cl.resolve(Ml)});return}ObjectSystemUtil.observer={next:function(Nl){RegionUtil.debug(Nl)},error:function(Ol){RegionUtil.error(Ol);ObjectSystemUtil.subscription=null;ObjectSystemUtil.observer=null;ObjectSystemUtil.file=null;Cl.resolve(2)},complete:function(Pl){RegionUtil.debug(Pl);RegionUtil.debug("complete");Dl.done(function(){ObjectSystemUtil.subscription=null;ObjectSystemUtil.observer=null;ObjectSystemUtil.file=null});ObjectSystemUtil.confirmFileUploaded(Gl.md5,Pl.key,Gl.fileType,Cl)}};var Ll=qiniu.upload(ObjectSystemUtil.file,Jl.fileKeyPrefix+ObjectSystemUtil.file.name,Gl.upToken,null,null);ObjectSystemUtil.subscription=Ll.subscribe(ObjectSystemUtil.observer)}else{Cl.resolve(Jl)}})});return Dl},confirmFileUploaded:function(Ql,Rl,Sl,Tl){var Ul=new Object;Ul.md5=Ql;Ul.fileKey=Rl;Ul.fileType=Sl;RegionUtil.ajaxJsonTask(Config.backendPath+"/RCS_Objectsystem/objectsystem/confirm-upload","POST",Ul,function(Vl,Wl){var Xl=Vl.data;Tl.resolve(Xl);if(window.filesInfo==null){window.filesInfo={}}window.filesInfo[Vl.data.fileId]=Vl.data})},subUploadFileToLocal:function(Yl,Zl,$l){var _l=ObjectSystemUtil.file;var am=new jQuery.Deferred;var bm=am.promise();var cm=new FormData;cm.append("upfile",_l);cm.append("md5",Zl);cm.append("fileType",$l);this.processingFileReq=$.ajax({type:"POST",url:Config.backendPath+"/RCS_Objectsystem/objectsystem/local-upload",data:cm,processData:false,contentType:false,xhr:function(){var dm=$.ajaxSettings.xhr();if(dm.upload){dm.upload.addEventListener("progress",function(em){var fm=RegionUtil.getEventTarget(em);var gm=em.loaded;var hm=em.total;var im=Math.floor(100*gm/hm)},false);return dm}},success:function(jm){console.log(jm);ObjectSystemUtil.file=null;if(jm.success==true){am.resolve(jm.data[0])}},error:function(km,lm,mm){ObjectSystemUtil.file=null;if(km.readyState==0){}else{am.resolve(2)}}});return bm}};